

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Device driver &mdash; Coyote v0.2.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=cc40f7fa"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Software" href="sw.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Coyote
              <img src="../_static/cyt_logo_dark.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/overview.html">System overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/quick-start.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/publications.html">Citation and publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/release-notes.html">Release notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="sw.html">Software</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Device driver</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#coyote-driver-h">coyote_driver.h</a></li>
<li class="toctree-l2"><a class="reference internal" href="#coyote-setup-h">coyote_setup.h</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417read_shell_configP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">read_shell_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423allocate_card_resourcesP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">allocate_card_resources()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419free_card_resourcesP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">free_card_resources()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415init_spin_locksP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">init_spin_locks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418create_sysfs_entryP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">create_sysfs_entry()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418remove_sysfs_entryP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">remove_sysfs_entry()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419alloc_vfpga_devicesP15bus_driver_data5dev_t"><code class="docutils literal notranslate"><span class="pre">alloc_vfpga_devices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419setup_vfpga_devicesP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">setup_vfpga_devices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422teardown_vfpga_devicesP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">teardown_vfpga_devices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418free_vfpga_devicesP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">free_vfpga_devices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421alloc_reconfig_deviceP15bus_driver_data5dev_t"><code class="docutils literal notranslate"><span class="pre">alloc_reconfig_device()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421setup_reconfig_deviceP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">setup_reconfig_device()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424teardown_reconfig_deviceP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">teardown_reconfig_device()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420free_reconfig_deviceP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">free_reconfig_device()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#coyote-sysfs-h">coyote_sysfs.h</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416cyt_attr_ip_showP7kobjectP14kobj_attributePc"><code class="docutils literal notranslate"><span class="pre">cyt_attr_ip_show()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417cyt_attr_ip_storeP7kobjectP14kobj_attributePKc6size_t"><code class="docutils literal notranslate"><span class="pre">cyt_attr_ip_store()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417cyt_attr_mac_showP7kobjectP14kobj_attributePc"><code class="docutils literal notranslate"><span class="pre">cyt_attr_mac_show()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418cyt_attr_mac_storeP7kobjectP14kobj_attributePKc6size_t"><code class="docutils literal notranslate"><span class="pre">cyt_attr_mac_store()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418cyt_attr_eost_showP7kobjectP14kobj_attributePc"><code class="docutils literal notranslate"><span class="pre">cyt_attr_eost_show()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419cyt_attr_eost_storeP7kobjectP14kobj_attributePKc6size_t"><code class="docutils literal notranslate"><span class="pre">cyt_attr_eost_store()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420cyt_attr_nstats_showP7kobjectP14kobj_attributePc"><code class="docutils literal notranslate"><span class="pre">cyt_attr_nstats_show()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420cyt_attr_xstats_showP7kobjectP14kobj_attributePc"><code class="docutils literal notranslate"><span class="pre">cyt_attr_xstats_show()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421cyt_attr_prstats_showP7kobjectP14kobj_attributePc"><code class="docutils literal notranslate"><span class="pre">cyt_attr_prstats_show()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421cyt_attr_engines_showP7kobjectP14kobj_attributePc"><code class="docutils literal notranslate"><span class="pre">cyt_attr_engines_show()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418cyt_attr_cnfg_showP7kobjectP14kobj_attributePc"><code class="docutils literal notranslate"><span class="pre">cyt_attr_cnfg_show()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#vfpga-gup-h">vfpga_gup.h</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415mmu_handler_gupP9vfpga_dev8uint64_t8uint64_t7int32_t7int32_t5pid_t"><code class="docutils literal notranslate"><span class="pre">mmu_handler_gup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411map_presentP9vfpga_devP15pf_aligned_desc"><code class="docutils literal notranslate"><span class="pre">map_present()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411tlb_map_gupP9vfpga_devP15pf_aligned_descP10user_pages5pid_t"><code class="docutils literal notranslate"><span class="pre">tlb_map_gup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413tlb_unmap_gupP9vfpga_devP10user_pages5pid_t"><code class="docutils literal notranslate"><span class="pre">tlb_unmap_gup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418tlb_get_user_pagesP9vfpga_devP15pf_aligned_desc5pid_tP11task_structP9mm_struct"><code class="docutils literal notranslate"><span class="pre">tlb_get_user_pages()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418tlb_put_user_pagesP9vfpga_dev8uint64_t7int32_t5pid_ti"><code class="docutils literal notranslate"><span class="pre">tlb_put_user_pages()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423tlb_put_user_pages_ctidP9vfpga_dev7int32_t5pid_ti"><code class="docutils literal notranslate"><span class="pre">tlb_put_user_pages_ctid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415migrate_to_cardP9vfpga_devP10user_pages"><code class="docutils literal notranslate"><span class="pre">migrate_to_card()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415migrate_to_hostP9vfpga_devP10user_pages"><code class="docutils literal notranslate"><span class="pre">migrate_to_host()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418offload_user_pagesP9vfpga_dev8uint64_t8uint32_t7int32_t"><code class="docutils literal notranslate"><span class="pre">offload_user_pages()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415sync_user_pagesP9vfpga_dev8uint64_t8uint32_t7int32_t"><code class="docutils literal notranslate"><span class="pre">sync_user_pages()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415p2p_move_notifyP18dma_buf_attachment"><code class="docutils literal notranslate"><span class="pre">p2p_move_notify()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418p2p_attach_dma_bufP9vfpga_devi8uint64_t7int32_t"><code class="docutils literal notranslate"><span class="pre">p2p_attach_dma_buf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418p2p_detach_dma_bufP9vfpga_dev8uint64_t7int32_ti"><code class="docutils literal notranslate"><span class="pre">p2p_detach_dma_buf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#vfpga-hw-h">vfpga_hw.h</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413read_irq_typeP9vfpga_dev"><code class="docutils literal notranslate"><span class="pre">read_irq_type()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415read_irq_notifyP9vfpga_devP16vfpga_irq_notify"><code class="docutils literal notranslate"><span class="pre">read_irq_notify()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415read_irq_pfaultP9vfpga_devP16vfpga_irq_pfault"><code class="docutils literal notranslate"><span class="pre">read_irq_pfault()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415drop_irq_pfaultP9vfpga_devb7int32_t"><code class="docutils literal notranslate"><span class="pre">drop_irq_pfault()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49clear_irqP9vfpga_dev"><code class="docutils literal notranslate"><span class="pre">clear_irq()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411restart_mmuP9vfpga_devb7int32_t"><code class="docutils literal notranslate"><span class="pre">restart_mmu()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420invalidate_tlb_entryP9vfpga_dev8uint64_t8uint32_t7int32_tb"><code class="docutils literal notranslate"><span class="pre">invalidate_tlb_entry()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415change_tlb_lockP9vfpga_dev"><code class="docutils literal notranslate"><span class="pre">change_tlb_lock()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418create_tlb_mappingP9vfpga_devP12tlb_metadata8uint64_t8uint64_t7int32_t7int32_t5pid_t"><code class="docutils literal notranslate"><span class="pre">create_tlb_mapping()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420create_tlb_unmappingP9vfpga_devP12tlb_metadata8uint64_t5pid_t"><code class="docutils literal notranslate"><span class="pre">create_tlb_unmapping()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419trigger_dma_offloadP9vfpga_devP8uint64_tP8uint64_t8uint32_tb"><code class="docutils literal notranslate"><span class="pre">trigger_dma_offload()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416trigger_dma_syncP9vfpga_devP8uint64_tP8uint64_t8uint32_tb"><code class="docutils literal notranslate"><span class="pre">trigger_dma_sync()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417alloc_card_memoryP9vfpga_devP8uint64_t8uint32_tb"><code class="docutils literal notranslate"><span class="pre">alloc_card_memory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416free_card_memoryP9vfpga_devP8uint64_t8uint32_tb"><code class="docutils literal notranslate"><span class="pre">free_card_memory()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#vfpga-isr-h">vfpga_isr.h</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49vfpga_isriPv"><code class="docutils literal notranslate"><span class="pre">vfpga_isr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420vfpga_notify_handlerP11work_struct"><code class="docutils literal notranslate"><span class="pre">vfpga_notify_handler()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420vfpga_pfault_handlerP11work_struct"><code class="docutils literal notranslate"><span class="pre">vfpga_pfault_handler()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#vfpga-ops-h">vfpga_ops.h</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414vfpga_dev_openP5inodeP4file"><code class="docutils literal notranslate"><span class="pre">vfpga_dev_open()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417vfpga_dev_releaseP5inodeP4file"><code class="docutils literal notranslate"><span class="pre">vfpga_dev_release()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415vfpga_dev_ioctlP4filejm"><code class="docutils literal notranslate"><span class="pre">vfpga_dev_ioctl()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414vfpga_dev_mmapP4fileP14vm_area_struct"><code class="docutils literal notranslate"><span class="pre">vfpga_dev_mmap()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#vfpga-uisr-h">vfpga_uisr.h</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422vfpga_register_eventfdP9vfpga_devii"><code class="docutils literal notranslate"><span class="pre">vfpga_register_eventfd()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424vfpga_unregister_eventfdP9vfpga_devi"><code class="docutils literal notranslate"><span class="pre">vfpga_unregister_eventfd()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reconfig-hw-h">reconfig_hw.h</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417reconfigure_startP12reconfig_dev8uint64_t8uint64_t5pid_t8uint32_t"><code class="docutils literal notranslate"><span class="pre">reconfigure_start()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reconfig-isr-h">reconfig_isr.h</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv412reconfig_isriPv"><code class="docutils literal notranslate"><span class="pre">reconfig_isr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reconfig-mem-h">reconfig_mem.h</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421alloc_reconfig_bufferP12reconfig_devm5pid_t8uint32_t"><code class="docutils literal notranslate"><span class="pre">alloc_reconfig_buffer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420free_reconfig_bufferP12reconfig_dev8uint64_t5pid_t8uint32_t"><code class="docutils literal notranslate"><span class="pre">free_reconfig_buffer()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reconfig-ops-h">reconfig_ops.h</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417reconfig_dev_openP5inodeP4file"><code class="docutils literal notranslate"><span class="pre">reconfig_dev_open()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420reconfig_dev_releaseP5inodeP4file"><code class="docutils literal notranslate"><span class="pre">reconfig_dev_release()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418reconfig_dev_ioctlP4filejm"><code class="docutils literal notranslate"><span class="pre">reconfig_dev_ioctl()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417reconfig_dev_mmapP4fileP14vm_area_struct"><code class="docutils literal notranslate"><span class="pre">reconfig_dev_mmap()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pci-util-h">pci_util.h</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49build_u328uint32_t8uint32_t"><code class="docutils literal notranslate"><span class="pre">build_u32()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421pci_enable_capabilityP7pci_devi"><code class="docutils literal notranslate"><span class="pre">pci_enable_capability()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv412msix_capableP7pci_dev"><code class="docutils literal notranslate"><span class="pre">msix_capable()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416build_vector_reg8uint32_t8uint32_t8uint32_t8uint32_t"><code class="docutils literal notranslate"><span class="pre">build_vector_reg()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pci-xdma-h">pci_xdma.h</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416assign_device_idP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">assign_device_id()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423vfpga_interrupts_enableP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">vfpga_interrupts_enable()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424vfpga_interrupts_disableP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">vfpga_interrupts_disable()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425reconfig_interrupt_enableP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">reconfig_interrupt_enable()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv426reconfig_interrupt_disableP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">reconfig_interrupt_disable()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415read_interruptsP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">read_interrupts()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418write_msix_vectorsP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">write_msix_vectors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49irq_setupP15bus_driver_dataP7pci_devb"><code class="docutils literal notranslate"><span class="pre">irq_setup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv412irq_teardownP15bus_driver_datab"><code class="docutils literal notranslate"><span class="pre">irq_teardown()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414pci_check_msixP15bus_driver_dataP7pci_dev"><code class="docutils literal notranslate"><span class="pre">pci_check_msix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421get_engine_channel_idP16xdma_engine_regs"><code class="docutils literal notranslate"><span class="pre">get_engine_channel_id()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413get_engine_idP16xdma_engine_regs"><code class="docutils literal notranslate"><span class="pre">get_engine_id()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422read_engine_alignmentsP11xdma_engine"><code class="docutils literal notranslate"><span class="pre">read_engine_alignments()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413engine_createP15bus_driver_dataiii"><code class="docutils literal notranslate"><span class="pre">engine_create()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416probe_for_engineP15bus_driver_dataii"><code class="docutils literal notranslate"><span class="pre">probe_for_engine()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413probe_enginesP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">probe_engines()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414engine_destroyP15bus_driver_dataP11xdma_engine"><code class="docutils literal notranslate"><span class="pre">engine_destroy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414remove_enginesP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">remove_engines()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414map_single_barP15bus_driver_dataP7pci_devii"><code class="docutils literal notranslate"><span class="pre">map_single_bar()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48map_barsP15bus_driver_dataP7pci_dev"><code class="docutils literal notranslate"><span class="pre">map_bars()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410unmap_barsP15bus_driver_dataP7pci_dev"><code class="docutils literal notranslate"><span class="pre">unmap_bars()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414shell_pci_initP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">shell_pci_init()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416shell_pci_removeP15bus_driver_data"><code class="docutils literal notranslate"><span class="pre">shell_pci_remove()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49pci_probeP7pci_devPK13pci_device_id"><code class="docutils literal notranslate"><span class="pre">pci_probe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410pci_removeP7pci_dev"><code class="docutils literal notranslate"><span class="pre">pci_remove()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48pci_initv"><code class="docutils literal notranslate"><span class="pre">pci_init()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48pci_exitv"><code class="docutils literal notranslate"><span class="pre">pci_exit()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Coyote</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Device driver</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/driver.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="device-driver">
<h1>Device driver<a class="headerlink" href="#device-driver" title="Link to this heading"></a></h1>
<section id="coyote-driver-h">
<h2>coyote_driver.h<a class="headerlink" href="#coyote-driver-h" title="Link to this heading"></a></h2>
<p>Top-level file of the Coyote driver; entry and exit point. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="coyote__driver_8h_1a0ccebf06d3408e29eb9644126b4fed16"></span><span class="sig-name descname"><span class="pre">static</span> <span class="pre">int</span> <span class="pre">__init</span> <span class="pre">coyote_init</span> <span class="pre">(void)</span></span></dt>
<dd><p>Top-level function of the Coyote driver, called when the driver is inserted. This function simply calls the <a class="reference internal" href="#pci__xdma_8h_1aea12ee1dea0b75b6bd3d1ba4c3293c5d"><span class="std std-ref">pci_init()</span></a> function, which is responsible for setting up the FPGA, vFPGAs, memory mappings etc. (see the documentation)</p>
<p>NOTE: In the past, we used to support Enzian (ECI) but it has been deprecated as of 2024. If you would like to add support for Enzian, reach out to us on GitHub or check how the code use to look before, with the diff commit being: 4555431cf251100e2f16255f7f49e9f02ddfb96d </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="coyote__driver_8h_1ab5e37545a53dcacf258479c21b173434"></span><span class="sig-name descname"><span class="pre">static</span> <span class="pre">void</span> <span class="pre">__exit</span> <span class="pre">coyote_exit</span> <span class="pre">(void)</span></span></dt>
<dd><p>Reverse of the init function, called when the driver is removed Handles device clean-up, memory freeing etc. See the documentation in pci_dev </p>
</dd></dl>

</div>
</section>
<section id="coyote-setup-h">
<h2>coyote_setup.h<a class="headerlink" href="#coyote-setup-h" title="Link to this heading"></a></h2>
<p>Functions for initializing, setting up and freeing Coyote devices (vfpga_dev, reconfig_dev) and utility functions (set up sysfs, reading config etc.) </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417read_shell_configP15bus_driver_data">
<span id="_CPPv317read_shell_configP15bus_driver_data"></span><span id="_CPPv217read_shell_configP15bus_driver_data"></span><span id="read_shell_config__bus_driver_dataP"></span><span class="target" id="coyote__setup_8h_1a3f4c705fd2769b18b75a7d43ff9492ea"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">read_shell_config</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417read_shell_configP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Reads the synthesized shell configuration and populates fields of bus_driver_data The configuration was specifified during the hardware synthesis in CMakeLists.txt The method also prints the configuration to the kernel log; can be queryed with <code class="docutils literal notranslate"><span class="pre">dmesg</span></code></p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423allocate_card_resourcesP15bus_driver_data">
<span id="_CPPv323allocate_card_resourcesP15bus_driver_data"></span><span id="_CPPv223allocate_card_resourcesP15bus_driver_data"></span><span id="allocate_card_resources__bus_driver_dataP"></span><span class="target" id="coyote__setup_8h_1af11d1cbd2a452ec672b27500ae68751a"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">allocate_card_resources</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423allocate_card_resourcesP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Allocates and initializes metadata structs used for managing card memory, if enabled. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419free_card_resourcesP15bus_driver_data">
<span id="_CPPv319free_card_resourcesP15bus_driver_data"></span><span id="_CPPv219free_card_resourcesP15bus_driver_data"></span><span id="free_card_resources__bus_driver_dataP"></span><span class="target" id="coyote__setup_8h_1af6196388fc06fa5a68bd28b91d2c139b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">free_card_resources</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419free_card_resourcesP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Releases metadata structs used for managing card memory, if enabled; opposite of allocate_card_resources. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415init_spin_locksP15bus_driver_data">
<span id="_CPPv315init_spin_locksP15bus_driver_data"></span><span id="_CPPv215init_spin_locksP15bus_driver_data"></span><span id="init_spin_locks__bus_driver_dataP"></span><span class="target" id="coyote__setup_8h_1a9f4f6879989bd2d1d0f8fb838faa9718"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">init_spin_locks</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415init_spin_locksP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Initialize general (not used by individual vFPGAs) spin locks used in Coyote; used to protect shared resources and ensure safe access. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418create_sysfs_entryP15bus_driver_data">
<span id="_CPPv318create_sysfs_entryP15bus_driver_data"></span><span id="_CPPv218create_sysfs_entryP15bus_driver_data"></span><span id="create_sysfs_entry__bus_driver_dataP"></span><span class="target" id="coyote__setup_8h_1a5d268c073e60f5e47742c810deb2a53a"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_sysfs_entry</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418create_sysfs_entryP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Initialize sysfs entry for Coyote; for more details see coyote_sysfs.h. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418remove_sysfs_entryP15bus_driver_data">
<span id="_CPPv318remove_sysfs_entryP15bus_driver_data"></span><span id="_CPPv218remove_sysfs_entryP15bus_driver_data"></span><span id="remove_sysfs_entry__bus_driver_dataP"></span><span class="target" id="coyote__setup_8h_1a9139430f455cf24650e7cc89ff1606ff"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">remove_sysfs_entry</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418remove_sysfs_entryP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Removes sysfs entry for Coyote; used oly when the driver is unloaded. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419alloc_vfpga_devicesP15bus_driver_data5dev_t">
<span id="_CPPv319alloc_vfpga_devicesP15bus_driver_data5dev_t"></span><span id="_CPPv219alloc_vfpga_devicesP15bus_driver_data5dev_t"></span><span id="alloc_vfpga_devices__bus_driver_dataP.dev_t"></span><span class="target" id="coyote__setup_8h_1af923820efc7c970927be669f70a11f00"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">alloc_vfpga_devices</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">dev_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">device</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419alloc_vfpga_devicesP15bus_driver_data5dev_t" title="Link to this definition"></a><br /></dt>
<dd><p>Allocates and registers all the char vFPGA devices (one for every region) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419setup_vfpga_devicesP15bus_driver_data">
<span id="_CPPv319setup_vfpga_devicesP15bus_driver_data"></span><span id="_CPPv219setup_vfpga_devicesP15bus_driver_data"></span><span id="setup_vfpga_devices__bus_driver_dataP"></span><span class="target" id="coyote__setup_8h_1a6aed8f4339cd0ce4061c950c2571d1bc"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">setup_vfpga_devices</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419setup_vfpga_devicesP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Sets up the previously allocated vFPGA char devices (above); memory mapping registers, initializing work queues, mutexes etc. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422teardown_vfpga_devicesP15bus_driver_data">
<span id="_CPPv322teardown_vfpga_devicesP15bus_driver_data"></span><span id="_CPPv222teardown_vfpga_devicesP15bus_driver_data"></span><span id="teardown_vfpga_devices__bus_driver_dataP"></span><span class="target" id="coyote__setup_8h_1a19bd97b4e642a020f5022a48c6a03087"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">teardown_vfpga_devices</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422teardown_vfpga_devicesP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Releases resources used by vFPGA char devices; destroys work queues etc., opposite of setup_vfpga_devices. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418free_vfpga_devicesP15bus_driver_data">
<span id="_CPPv318free_vfpga_devicesP15bus_driver_data"></span><span id="_CPPv218free_vfpga_devicesP15bus_driver_data"></span><span id="free_vfpga_devices__bus_driver_dataP"></span><span class="target" id="coyote__setup_8h_1ae0944b69ca2971ce81f3fa78cfbbae04"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">free_vfpga_devices</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418free_vfpga_devicesP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Frees the allocated vFPGA char devices and unregisters it from the OS; opposite of alloc_vfpga_devices. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421alloc_reconfig_deviceP15bus_driver_data5dev_t">
<span id="_CPPv321alloc_reconfig_deviceP15bus_driver_data5dev_t"></span><span id="_CPPv221alloc_reconfig_deviceP15bus_driver_data5dev_t"></span><span id="alloc_reconfig_device__bus_driver_dataP.dev_t"></span><span class="target" id="coyote__setup_8h_1a361e79d27e7f527248624f3af6e36f3a"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">alloc_reconfig_device</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">dev_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">device</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421alloc_reconfig_deviceP15bus_driver_data5dev_t" title="Link to this definition"></a><br /></dt>
<dd><p>Allocates a char reconfig_device which is used to interact with the static layer for shell reconfiguration. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421setup_reconfig_deviceP15bus_driver_data">
<span id="_CPPv321setup_reconfig_deviceP15bus_driver_data"></span><span id="_CPPv221setup_reconfig_deviceP15bus_driver_data"></span><span id="setup_reconfig_device__bus_driver_dataP"></span><span class="target" id="coyote__setup_8h_1a517a141ac386ef091aaae2dd202dd8ac"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">setup_reconfig_device</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421setup_reconfig_deviceP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Sets up the previously allocated reconfig char device (above); initializing work queues, mutexes, hash tables etc. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424teardown_reconfig_deviceP15bus_driver_data">
<span id="_CPPv324teardown_reconfig_deviceP15bus_driver_data"></span><span id="_CPPv224teardown_reconfig_deviceP15bus_driver_data"></span><span id="teardown_reconfig_device__bus_driver_dataP"></span><span class="target" id="coyote__setup_8h_1aab5ed76e71ba07645a40aba1a35cfa1e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">teardown_reconfig_device</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424teardown_reconfig_deviceP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Releases resources used by the reconfig device; destroys work queues etc., opposite of setup_reconfig_device. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420free_reconfig_deviceP15bus_driver_data">
<span id="_CPPv320free_reconfig_deviceP15bus_driver_data"></span><span id="_CPPv220free_reconfig_deviceP15bus_driver_data"></span><span id="free_reconfig_device__bus_driver_dataP"></span><span class="target" id="coyote__setup_8h_1ab34c0539f7d08f8d95cb7390c77fd7be"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">free_reconfig_device</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420free_reconfig_deviceP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Frees the allocated reconfig char device and unregisters it from the OS; opposite of alloc_reconfig_device. </p>
</dd></dl>

</div>
</section>
<section id="coyote-sysfs-h">
<h2>coyote_sysfs.h<a class="headerlink" href="#coyote-sysfs-h" title="Link to this heading"></a></h2>
<p>Coyote sysfs module. </p>
<p>sysfs is a virtual filesystem in Linux that exposes kernel objects and their attributes to the user-space It can be used for reading and writing various attributes of devices in the kernel-space The following methods retrieve or set attributes from memory-mapped FPGA registers The attributes can also be read and set from a standard Linux terminal, e.g., cat /sys/kernel/coyote_sysfs_0/&lt;attribute&gt;</p>
<p>In general, the methods in this file follow similar steps:<ol class="arabic simple">
<li><p>Parse a generic kernel object (kobj) into a Coyote-specific variable of type bus_driver_data</p></li>
<li><p>Ensure the parsed object is non-null, using BUG_ON(…)</p></li>
<li><p>Retrieve or set the target attribute </p></li>
</ol>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416cyt_attr_ip_showP7kobjectP14kobj_attributePc">
<span id="_CPPv316cyt_attr_ip_showP7kobjectP14kobj_attributePc"></span><span id="_CPPv216cyt_attr_ip_showP7kobjectP14kobj_attributePc"></span><span id="cyt_attr_ip_show__kobjectP.kobj_attributeP.cP"></span><span class="target" id="coyote__sysfs_8h_1a089f3cd89b3bc75021ec7547bdd082df"></span><span class="n"><span class="pre">ssize_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cyt_attr_ip_show</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobject</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">kobj</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobj_attribute</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">attr</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buf</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416cyt_attr_ip_showP7kobjectP14kobj_attributePc" title="Link to this definition"></a><br /></dt>
<dd><p>Get FPGA IP address. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417cyt_attr_ip_storeP7kobjectP14kobj_attributePKc6size_t">
<span id="_CPPv317cyt_attr_ip_storeP7kobjectP14kobj_attributePKc6size_t"></span><span id="_CPPv217cyt_attr_ip_storeP7kobjectP14kobj_attributePKc6size_t"></span><span id="cyt_attr_ip_store__kobjectP.kobj_attributeP.cCP.s"></span><span class="target" id="coyote__sysfs_8h_1a520d2fa41d49e4598e503d0c9787aff4"></span><span class="n"><span class="pre">ssize_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cyt_attr_ip_store</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobject</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">kobj</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobj_attribute</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">attr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buf</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">count</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417cyt_attr_ip_storeP7kobjectP14kobj_attributePKc6size_t" title="Link to this definition"></a><br /></dt>
<dd><p>Set FPGA IP address. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417cyt_attr_mac_showP7kobjectP14kobj_attributePc">
<span id="_CPPv317cyt_attr_mac_showP7kobjectP14kobj_attributePc"></span><span id="_CPPv217cyt_attr_mac_showP7kobjectP14kobj_attributePc"></span><span id="cyt_attr_mac_show__kobjectP.kobj_attributeP.cP"></span><span class="target" id="coyote__sysfs_8h_1af3d9f9f831dd7208c5768235f5e56be3"></span><span class="n"><span class="pre">ssize_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cyt_attr_mac_show</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobject</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">kobj</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobj_attribute</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">attr</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buf</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417cyt_attr_mac_showP7kobjectP14kobj_attributePc" title="Link to this definition"></a><br /></dt>
<dd><p>Get FPGA MAC address. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418cyt_attr_mac_storeP7kobjectP14kobj_attributePKc6size_t">
<span id="_CPPv318cyt_attr_mac_storeP7kobjectP14kobj_attributePKc6size_t"></span><span id="_CPPv218cyt_attr_mac_storeP7kobjectP14kobj_attributePKc6size_t"></span><span id="cyt_attr_mac_store__kobjectP.kobj_attributeP.cCP.s"></span><span class="target" id="coyote__sysfs_8h_1a5a4d452447638b3f812676dc03aefe3b"></span><span class="n"><span class="pre">ssize_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cyt_attr_mac_store</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobject</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">kobj</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobj_attribute</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">attr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buf</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">count</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418cyt_attr_mac_storeP7kobjectP14kobj_attributePKc6size_t" title="Link to this definition"></a><br /></dt>
<dd><p>Set FPGA MAC address. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418cyt_attr_eost_showP7kobjectP14kobj_attributePc">
<span id="_CPPv318cyt_attr_eost_showP7kobjectP14kobj_attributePc"></span><span id="_CPPv218cyt_attr_eost_showP7kobjectP14kobj_attributePc"></span><span id="cyt_attr_eost_show__kobjectP.kobj_attributeP.cP"></span><span class="target" id="coyote__sysfs_8h_1af893302b51a3ad78bb06ab1b7f50586c"></span><span class="n"><span class="pre">ssize_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cyt_attr_eost_show</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobject</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">kobj</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobj_attribute</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">attr</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buf</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418cyt_attr_eost_showP7kobjectP14kobj_attributePc" title="Link to this definition"></a><br /></dt>
<dd><p>Get PR end of start-up (EOS) time. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419cyt_attr_eost_storeP7kobjectP14kobj_attributePKc6size_t">
<span id="_CPPv319cyt_attr_eost_storeP7kobjectP14kobj_attributePKc6size_t"></span><span id="_CPPv219cyt_attr_eost_storeP7kobjectP14kobj_attributePKc6size_t"></span><span id="cyt_attr_eost_store__kobjectP.kobj_attributeP.cCP.s"></span><span class="target" id="coyote__sysfs_8h_1af7f2037435d68863d26e0b08cafe6275"></span><span class="n"><span class="pre">ssize_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cyt_attr_eost_store</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobject</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">kobj</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobj_attribute</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">attr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buf</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">count</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419cyt_attr_eost_storeP7kobjectP14kobj_attributePKc6size_t" title="Link to this definition"></a><br /></dt>
<dd><p>Set PR end of start-up (EOS) time. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420cyt_attr_nstats_showP7kobjectP14kobj_attributePc">
<span id="_CPPv320cyt_attr_nstats_showP7kobjectP14kobj_attributePc"></span><span id="_CPPv220cyt_attr_nstats_showP7kobjectP14kobj_attributePc"></span><span id="cyt_attr_nstats_show__kobjectP.kobj_attributeP.cP"></span><span class="target" id="coyote__sysfs_8h_1af5d0eb4ef282aef5983a05dfecb90cd6"></span><span class="n"><span class="pre">ssize_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cyt_attr_nstats_show</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobject</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">kobj</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobj_attribute</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">attr</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buf</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420cyt_attr_nstats_showP7kobjectP14kobj_attributePc" title="Link to this definition"></a><br /></dt>
<dd><p>Get network stats on port QSFP0. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420cyt_attr_xstats_showP7kobjectP14kobj_attributePc">
<span id="_CPPv320cyt_attr_xstats_showP7kobjectP14kobj_attributePc"></span><span id="_CPPv220cyt_attr_xstats_showP7kobjectP14kobj_attributePc"></span><span id="cyt_attr_xstats_show__kobjectP.kobj_attributeP.cP"></span><span class="target" id="coyote__sysfs_8h_1ad4315693c1f06272712a6f5fe21567e9"></span><span class="n"><span class="pre">ssize_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cyt_attr_xstats_show</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobject</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">kobj</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobj_attribute</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">attr</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buf</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420cyt_attr_xstats_showP7kobjectP14kobj_attributePc" title="Link to this definition"></a><br /></dt>
<dd><p>Get XDMA stats. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421cyt_attr_prstats_showP7kobjectP14kobj_attributePc">
<span id="_CPPv321cyt_attr_prstats_showP7kobjectP14kobj_attributePc"></span><span id="_CPPv221cyt_attr_prstats_showP7kobjectP14kobj_attributePc"></span><span id="cyt_attr_prstats_show__kobjectP.kobj_attributeP.cP"></span><span class="target" id="coyote__sysfs_8h_1a066fa4209c18634e73a1bddcf2d6439e"></span><span class="n"><span class="pre">ssize_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cyt_attr_prstats_show</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobject</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">kobj</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobj_attribute</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">attr</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buf</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421cyt_attr_prstats_showP7kobjectP14kobj_attributePc" title="Link to this definition"></a><br /></dt>
<dd><p>Get partial reconfiguration stats. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421cyt_attr_engines_showP7kobjectP14kobj_attributePc">
<span id="_CPPv321cyt_attr_engines_showP7kobjectP14kobj_attributePc"></span><span id="_CPPv221cyt_attr_engines_showP7kobjectP14kobj_attributePc"></span><span id="cyt_attr_engines_show__kobjectP.kobj_attributeP.cP"></span><span class="target" id="coyote__sysfs_8h_1a76e823f66a30e82dfe8837ff8a6db5b3"></span><span class="n"><span class="pre">ssize_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cyt_attr_engines_show</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobject</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">kobj</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobj_attribute</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">attr</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buf</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421cyt_attr_engines_showP7kobjectP14kobj_attributePc" title="Link to this definition"></a><br /></dt>
<dd><p>Get engine stats. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418cyt_attr_cnfg_showP7kobjectP14kobj_attributePc">
<span id="_CPPv318cyt_attr_cnfg_showP7kobjectP14kobj_attributePc"></span><span id="_CPPv218cyt_attr_cnfg_showP7kobjectP14kobj_attributePc"></span><span id="cyt_attr_cnfg_show__kobjectP.kobj_attributeP.cP"></span><span class="target" id="coyote__sysfs_8h_1a3acdf57f663117f3a2b6eac38f92b82c"></span><span class="n"><span class="pre">ssize_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cyt_attr_cnfg_show</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobject</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">kobj</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">kobj_attribute</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">attr</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buf</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418cyt_attr_cnfg_showP7kobjectP14kobj_attributePc" title="Link to this definition"></a><br /></dt>
<dd><p>Get Coyote FPGA configuration (N_REGIONS, EN_MEM, EN_STRM, EN_PR, EN_RDMA, TLB config etc.) </p>
</dd></dl>

</div>
</section>
<section id="vfpga-gup-h">
<h2>vfpga_gup.h<a class="headerlink" href="#vfpga-gup-h" title="Link to this heading"></a></h2>
<p>Header file for memory management of vFPGAs. </p>
<p>This file defines the functions for handling page faults, managing user pages, exporting necessary DMA Buffers for FPGA-GPU communication. NOTE: GUP stands for “Get User Pages”, which is a Linux kernel mechanism to pin user-space pages in memory and Coyote swaps the pages between host and card. NOTE: Previously (currently in LEGACY), there was an alternative memory management mechanism, using Linux’s Hetereogeneous Memory Management (HMM) framework.</p>
<p>The mapped user pages are stored in a hash_table, called user_buff_map Functions in this file implement high-level logic for managing Coyote memory And call functions in vfpga_hw.h that handle the low-level logic by writing to the memory-mapped registers in the FPGA Additionally, this file provides functions for peer-to-peer DMA Buffer management, enabling direct FPGA-GPU communication.</p>
<p>Important functions in this file include:<ul class="simple">
<li><p>mmu_handler_gup; the top-level function, handles page faults issued by the FPGA</p></li>
<li><p>tlb_map_gup and tlb_unmap_gup; which maps/unmaps user pages to the TLB</p></li>
<li><p>offload_user_pages and sync_user_pages; handling the offloading and syncing of user pages between host and card</p></li>
<li><p>P2P DMA Buffer functions for managing DMA Buffers to FPGA-GPU communication </p></li>
</ul>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415mmu_handler_gupP9vfpga_dev8uint64_t8uint64_t7int32_t7int32_t5pid_t">
<span id="_CPPv315mmu_handler_gupP9vfpga_dev8uint64_t8uint64_t7int32_t7int32_t5pid_t"></span><span id="_CPPv215mmu_handler_gupP9vfpga_dev8uint64_t8uint64_t7int32_t7int32_t5pid_t"></span><span id="mmu_handler_gup__vfpga_devP.uint64_t.uint64_t.int32_t.int32_t.pid_t"></span><span class="target" id="vfpga__gup_8h_1a001ef2e41106a33860cb9267a0d65c1b"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mmu_handler_gup</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vaddr</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">len</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ctid</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span>, <span class="n"><span class="pre">pid_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">hpid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415mmu_handler_gupP9vfpga_dev8uint64_t8uint64_t7int32_t7int32_t5pid_t" title="Link to this definition"></a><br /></dt>
<dd><p>Top-level function; handles page faults issued by the FPGA. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>vaddr</strong> – Buffer virtual address corresponding to the page fault </p></li>
<li><p><strong>len</strong> – Length, in bytes, of the page-faulting buffer </p></li>
<li><p><strong>ctid</strong> – Coyote thread ID </p></li>
<li><p><strong>stream</strong> – Access type: HOST (1) or CARD (0) </p></li>
<li><p><strong>hpid</strong> – Host process ID </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success, negative error code on failure </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411map_presentP9vfpga_devP15pf_aligned_desc">
<span id="_CPPv311map_presentP9vfpga_devP15pf_aligned_desc"></span><span id="_CPPv211map_presentP9vfpga_devP15pf_aligned_desc"></span><span id="map_present__vfpga_devP.pf_aligned_descP"></span><span class="target" id="vfpga__gup_8h_1a6be4a461cff344d817b507ed06bae5ab"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">user_pages</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">map_present</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pf_aligned_desc</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pf_desc</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411map_presentP9vfpga_devP15pf_aligned_desc" title="Link to this definition"></a><br /></dt>
<dd><p>Checks if a mapping is already present in the user buffer map. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>pf_desc</strong> – Aligned page fault descriptor; holds info about virtual address, length etc. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pointer to the user_pages structure if mapping exists, NULL otherwise </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411tlb_map_gupP9vfpga_devP15pf_aligned_descP10user_pages5pid_t">
<span id="_CPPv311tlb_map_gupP9vfpga_devP15pf_aligned_descP10user_pages5pid_t"></span><span id="_CPPv211tlb_map_gupP9vfpga_devP15pf_aligned_descP10user_pages5pid_t"></span><span id="tlb_map_gup__vfpga_devP.pf_aligned_descP.user_pagesP.pid_t"></span><span class="target" id="vfpga__gup_8h_1a9452724d53002c040a161164e7c35172"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tlb_map_gup</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pf_aligned_desc</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pf_desc</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">user_pages</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">user_pg</span></span>, <span class="n"><span class="pre">pid_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">hpid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411tlb_map_gupP9vfpga_devP15pf_aligned_descP10user_pages5pid_t" title="Link to this definition"></a><br /></dt>
<dd><p>Creates a TLB mapping for the given user pages. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>pf_desc</strong> – Aligned page fault descriptor; holds info about virtual address, length etc. </p></li>
<li><p><strong>user_pg</strong> – User pages structure </p></li>
<li><p><strong>hpid</strong> – Host process ID </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413tlb_unmap_gupP9vfpga_devP10user_pages5pid_t">
<span id="_CPPv313tlb_unmap_gupP9vfpga_devP10user_pages5pid_t"></span><span id="_CPPv213tlb_unmap_gupP9vfpga_devP10user_pages5pid_t"></span><span id="tlb_unmap_gup__vfpga_devP.user_pagesP.pid_t"></span><span class="target" id="vfpga__gup_8h_1a45267972c0e85e728d9a163d74e36119"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tlb_unmap_gup</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">user_pages</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">user_pg</span></span>, <span class="n"><span class="pre">pid_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">hpid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413tlb_unmap_gupP9vfpga_devP10user_pages5pid_t" title="Link to this definition"></a><br /></dt>
<dd><p>Removes a TLB mapping for the given user pages. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>pf_desc</strong> – Aligned page fault descriptor; holds info about virtual address, length etc. </p></li>
<li><p><strong>hpid</strong> – Host process ID </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418tlb_get_user_pagesP9vfpga_devP15pf_aligned_desc5pid_tP11task_structP9mm_struct">
<span id="_CPPv318tlb_get_user_pagesP9vfpga_devP15pf_aligned_desc5pid_tP11task_structP9mm_struct"></span><span id="_CPPv218tlb_get_user_pagesP9vfpga_devP15pf_aligned_desc5pid_tP11task_structP9mm_struct"></span><span id="tlb_get_user_pages__vfpga_devP.pf_aligned_descP.pid_t.task_structP.mm_structP"></span><span class="target" id="vfpga__gup_8h_1af91815858044964a6df52149a4e84a30"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">user_pages</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">tlb_get_user_pages</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pf_aligned_desc</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pf_desc</span></span>, <span class="n"><span class="pre">pid_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">hpid</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">task_struct</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">curr_task</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">mm_struct</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">curr_mm</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418tlb_get_user_pagesP9vfpga_devP15pf_aligned_desc5pid_tP11task_structP9mm_struct" title="Link to this definition"></a><br /></dt>
<dd><p>Pins user pages and prepares them for TLB mapping. </p>
<p>A function that is first called when no mapping for a user page exists In this case, the function performs the following:<ul class="simple">
<li><p>Allocates a new user_pages struct which holds informaton about page physical address, length etc.,</p></li>
<li><p>Pins the pages, to avoid them being swapped out</p></li>
<li><p>Flushes the cache to ensure data consistency between the FPGA and the CPU</p></li>
<li><p>Allocates the corresponding card buffer, if memory is enabled This function is immediately followed by a call to tlb_map_gup, which maps the user pages to the vFPGA’s TLB</p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>pf_desc</strong> – Aligned page fault descriptor </p></li>
<li><p><strong>hpid</strong> – Host process ID </p></li>
<li><p><strong>curr_task</strong> – Current task structure </p></li>
<li><p><strong>curr_mm</strong> – Current memory management structure </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pointer to the user_pages structure on success, NULL on failure </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418tlb_put_user_pagesP9vfpga_dev8uint64_t7int32_t5pid_ti">
<span id="_CPPv318tlb_put_user_pagesP9vfpga_dev8uint64_t7int32_t5pid_ti"></span><span id="_CPPv218tlb_put_user_pagesP9vfpga_dev8uint64_t7int32_t5pid_ti"></span><span id="tlb_put_user_pages__vfpga_devP.uint64_t.int32_t.pid_t.i"></span><span class="target" id="vfpga__gup_8h_1a18979bad45fa00e4b5b55c9dee90a8f3"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tlb_put_user_pages</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vaddr</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ctid</span></span>, <span class="n"><span class="pre">pid_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">hpid</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dirtied</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418tlb_put_user_pagesP9vfpga_dev8uint64_t7int32_t5pid_ti" title="Link to this definition"></a><br /></dt>
<dd><p>Releases user pages and removes their TLB mappings. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>vaddr</strong> – Starting virtual address </p></li>
<li><p><strong>ctid</strong> – Coyote thread ID for which the pages were mapped </p></li>
<li><p><strong>hpid</strong> – Host process ID for which the pages were mapped </p></li>
<li><p><strong>dirtied</strong> – Indicates if the pages were modified </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success, negative error code on failure </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423tlb_put_user_pages_ctidP9vfpga_dev7int32_t5pid_ti">
<span id="_CPPv323tlb_put_user_pages_ctidP9vfpga_dev7int32_t5pid_ti"></span><span id="_CPPv223tlb_put_user_pages_ctidP9vfpga_dev7int32_t5pid_ti"></span><span id="tlb_put_user_pages_ctid__vfpga_devP.int32_t.pid_t.i"></span><span class="target" id="vfpga__gup_8h_1ae9139e17a22ed8a308699c9e2349aff1"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tlb_put_user_pages_ctid</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ctid</span></span>, <span class="n"><span class="pre">pid_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">hpid</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dirtied</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423tlb_put_user_pages_ctidP9vfpga_dev7int32_t5pid_ti" title="Link to this definition"></a><br /></dt>
<dd><p>Releases all user pages for a given Coyote thread. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>ctid</strong> – Coyote thread ID for which the pages should be released </p></li>
<li><p><strong>hpid</strong> – Host process ID associated with the Coyote thread </p></li>
<li><p><strong>dirtied</strong> – Indicates if the pages were modified </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success, negative error code on failure </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415migrate_to_cardP9vfpga_devP10user_pages">
<span id="_CPPv315migrate_to_cardP9vfpga_devP10user_pages"></span><span id="_CPPv215migrate_to_cardP9vfpga_devP10user_pages"></span><span id="migrate_to_card__vfpga_devP.user_pagesP"></span><span class="target" id="vfpga__gup_8h_1a25a8741189a7c5a5b9a6183a9638b296"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">migrate_to_card</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">user_pages</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">user_pg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415migrate_to_cardP9vfpga_devP10user_pages" title="Link to this definition"></a><br /></dt>
<dd><p>Helper function, migrates user pages to card memory. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>user_pg</strong> – User pages to be migrated </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415migrate_to_hostP9vfpga_devP10user_pages">
<span id="_CPPv315migrate_to_hostP9vfpga_devP10user_pages"></span><span id="_CPPv215migrate_to_hostP9vfpga_devP10user_pages"></span><span id="migrate_to_host__vfpga_devP.user_pagesP"></span><span class="target" id="vfpga__gup_8h_1aa06e92900c12a0707b485480309a0661"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">migrate_to_host</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">user_pages</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">user_pg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415migrate_to_hostP9vfpga_devP10user_pages" title="Link to this definition"></a><br /></dt>
<dd><p>Helper function, migrates user pages back to the host memory. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>user_pg</strong> – User pages to be migrated </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418offload_user_pagesP9vfpga_dev8uint64_t8uint32_t7int32_t">
<span id="_CPPv318offload_user_pagesP9vfpga_dev8uint64_t8uint32_t7int32_t"></span><span id="_CPPv218offload_user_pagesP9vfpga_dev8uint64_t8uint32_t7int32_t"></span><span id="offload_user_pages__vfpga_devP.uint64_t.uint32_t.int32_t"></span><span class="target" id="vfpga__gup_8h_1a5a3d5d02552f6b543dbdd9d95c522d1e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">offload_user_pages</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vaddr</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">len</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ctid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418offload_user_pagesP9vfpga_dev8uint64_t8uint32_t7int32_t" title="Link to this definition"></a><br /></dt>
<dd><p>Trigger off-load operation; moving pages from host to card &amp; updating mappings. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>vaddr</strong> – Starting virtual address of the buffer to be offloaded </p></li>
<li><p><strong>len</strong> – Length, in bytes, of the buffer to be offloaded </p></li>
<li><p><strong>ctid</strong> – Coyote thread ID </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success, negative error code on failure </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415sync_user_pagesP9vfpga_dev8uint64_t8uint32_t7int32_t">
<span id="_CPPv315sync_user_pagesP9vfpga_dev8uint64_t8uint32_t7int32_t"></span><span id="_CPPv215sync_user_pagesP9vfpga_dev8uint64_t8uint32_t7int32_t"></span><span id="sync_user_pages__vfpga_devP.uint64_t.uint32_t.int32_t"></span><span class="target" id="vfpga__gup_8h_1a2432a291da6995ab2a503bce32c5856b"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sync_user_pages</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vaddr</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">len</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ctid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415sync_user_pagesP9vfpga_dev8uint64_t8uint32_t7int32_t" title="Link to this definition"></a><br /></dt>
<dd><p>Trigger sync operation; moving pages from card to host &amp; updating mappings. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>vaddr</strong> – Starting virtual address of the buffer to be synced </p></li>
<li><p><strong>len</strong> – Length, in bytes, of the buffer to be synced </p></li>
<li><p><strong>ctid</strong> – Coyote thread ID </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success, negative error code on failure </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415p2p_move_notifyP18dma_buf_attachment">
<span id="_CPPv315p2p_move_notifyP18dma_buf_attachment"></span><span id="_CPPv215p2p_move_notifyP18dma_buf_attachment"></span><span id="p2p_move_notify__dma_buf_attachmentP"></span><span class="target" id="vfpga__gup_8h_1ae20199502b55cb257c964d53854b0274"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">p2p_move_notify</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">dma_buf_attachment</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">attach</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415p2p_move_notifyP18dma_buf_attachment" title="Link to this definition"></a><br /></dt>
<dd><p>Callback for handling page movement notifications in peer-to-peer DMA. </p>
<p>To manage page movements in GPU memory, this routines deletes TLB entries and retrieves new entries It is passed as a parameter to the dma_buf_attach_ops struct, which is used when attaching the DMA Buffer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>attach</strong> – DMA buffer attachment structure </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418p2p_attach_dma_bufP9vfpga_devi8uint64_t7int32_t">
<span id="_CPPv318p2p_attach_dma_bufP9vfpga_devi8uint64_t7int32_t"></span><span id="_CPPv218p2p_attach_dma_bufP9vfpga_devi8uint64_t7int32_t"></span><span id="p2p_attach_dma_buf__vfpga_devP.i.uint64_t.int32_t"></span><span class="target" id="vfpga__gup_8h_1a968f77fc29ca99c4353d2716118f9886"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">p2p_attach_dma_buf</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">buf_fd</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vaddr</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ctid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418p2p_attach_dma_bufP9vfpga_devi8uint64_t7int32_t" title="Link to this definition"></a><br /></dt>
<dd><p>Attaches a DMA buffer to the vFPGA. </p>
<p>In general, this functions implements similary logic as tlb_get_user_pages, but for DMA Buffers Functionality includes:<ul class="simple">
<li><p>Allocating a new user_pages struct which holds informaton about page physical address, length etc.,</p></li>
<li><p>Attaches the DMA Buffer to the vFPGA char device, allowing the vFPGA to access the buffer</p></li>
<li><p>Maps the DMA Buffer to the FPGA’s address spae, by providing a scatter-gather list represnting the physical memory of the buffer</p></li>
<li><p>Allocate corresponding card buffer, if memory is enabled</p></li>
<li><p>Maps the physical to virtual translations to the vFPGA’s TLB using tlb_map_gup</p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>buf_fd</strong> – File descriptor of the DMA buffer </p></li>
<li><p><strong>vaddr</strong> – Virtual address to map the buffer </p></li>
<li><p><strong>ctid</strong> – Coyote thread ID </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success, negative error code on failure </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418p2p_detach_dma_bufP9vfpga_dev8uint64_t7int32_ti">
<span id="_CPPv318p2p_detach_dma_bufP9vfpga_dev8uint64_t7int32_ti"></span><span id="_CPPv218p2p_detach_dma_bufP9vfpga_dev8uint64_t7int32_ti"></span><span id="p2p_detach_dma_buf__vfpga_devP.uint64_t.int32_t.i"></span><span class="target" id="vfpga__gup_8h_1a89c923c84a097d4019ccfdf64437d4f3"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">p2p_detach_dma_buf</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vaddr</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ctid</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dirtied</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418p2p_detach_dma_bufP9vfpga_dev8uint64_t7int32_ti" title="Link to this definition"></a><br /></dt>
<dd><p>Detaches a DMA buffer from the vFPGA device. </p>
<p>In general, this functions implements similary logic as tlb_put_user_pages, but for DMA Buffers It is called at the end of the Coyote thread’s execution, when the buffer is no longer needed Functionality includes (which is largely opposite to p2p_attach_dma_buf):<ul class="simple">
<li><p>Removing the TLB entries using tlb_unmap_gup</p></li>
<li><p>Freeing card memory, if memory is enabled</p></li>
<li><p>Unmapping the DMA Buffer from the vFPGA’s address space</p></li>
<li><p>Detaching the vFPGA device from the DMA Buffer</p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>vaddr</strong> – Virtual address of the buffer </p></li>
<li><p><strong>ctid</strong> – Coyote thread ID </p></li>
<li><p><strong>dirtied</strong> – Indicates if the buffer was modified </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success, negative error code on failure </p>
</dd>
</dl>
</dd></dl>

</div>
</section>
<section id="vfpga-hw-h">
<h2>vfpga_hw.h<a class="headerlink" href="#vfpga-hw-h" title="Link to this heading"></a></h2>
<p>vFPGA hardware functions </p>
<p>Functions in this file are primarily used for low-level hardware operations in the vFPGA Typically, this includes writing to or reading from hardware registers, which are memory-mapped during driver loading The registers typically start an operation in hardware or contain some control flow data (virtual address, length etc.) </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413read_irq_typeP9vfpga_dev">
<span id="_CPPv313read_irq_typeP9vfpga_dev"></span><span id="_CPPv213read_irq_typeP9vfpga_dev"></span><span id="read_irq_type__vfpga_devP"></span><span class="target" id="vfpga__hw_8h_1a1b74732bcb00e1361ad5d96284e1b678"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">read_irq_type</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413read_irq_typeP9vfpga_dev" title="Link to this definition"></a><br /></dt>
<dd><p>Parse interrupt type. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> – vFPGA char device </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>type of interrupt (IRQ_DMA_OFFL, IRQ_DMA_SYNC, IRQ_INVLDT, IRQ_PFAULT, IRQ_NOTIFY) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415read_irq_notifyP9vfpga_devP16vfpga_irq_notify">
<span id="_CPPv315read_irq_notifyP9vfpga_devP16vfpga_irq_notify"></span><span id="_CPPv215read_irq_notifyP9vfpga_devP16vfpga_irq_notify"></span><span id="read_irq_notify__vfpga_devP.vfpga_irq_notifyP"></span><span class="target" id="vfpga__hw_8h_1a840121177adf277d5025a59a612610e3"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">read_irq_notify</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_irq_notify</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">irq_not</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415read_irq_notifyP9vfpga_devP16vfpga_irq_notify" title="Link to this definition"></a><br /></dt>
<dd><p>Parse user notification IRQ. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>irq_not</strong> – notification struct, to be set (updated) by this function </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415read_irq_pfaultP9vfpga_devP16vfpga_irq_pfault">
<span id="_CPPv315read_irq_pfaultP9vfpga_devP16vfpga_irq_pfault"></span><span id="_CPPv215read_irq_pfaultP9vfpga_devP16vfpga_irq_pfault"></span><span id="read_irq_pfault__vfpga_devP.vfpga_irq_pfaultP"></span><span class="target" id="vfpga__hw_8h_1a03e10bddce57af1a1bc7e3bf3b6bb8b1"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">read_irq_pfault</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_irq_pfault</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">irq_pf</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415read_irq_pfaultP9vfpga_devP16vfpga_irq_pfault" title="Link to this definition"></a><br /></dt>
<dd><p>Parse page fault IRQ. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>irq_pf</strong> – page fault struct, to be set (updated) by this function </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415drop_irq_pfaultP9vfpga_devb7int32_t">
<span id="_CPPv315drop_irq_pfaultP9vfpga_devb7int32_t"></span><span id="_CPPv215drop_irq_pfaultP9vfpga_devb7int32_t"></span><span id="drop_irq_pfault__vfpga_devP.b.int32_t"></span><span class="target" id="vfpga__hw_8h_1ad935c14ef139e5f152c97662c35f0170"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">drop_irq_pfault</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">write</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ctid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415drop_irq_pfaultP9vfpga_devb7int32_t" title="Link to this definition"></a><br /></dt>
<dd><p>Drops the page fault, because it went wrong somewhere. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>write</strong> – write operation (true) or read operation (false) </p></li>
<li><p><strong>ctid</strong> – Coyote thread ID </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv49clear_irqP9vfpga_dev">
<span id="_CPPv39clear_irqP9vfpga_dev"></span><span id="_CPPv29clear_irqP9vfpga_dev"></span><span id="clear_irq__vfpga_devP"></span><span class="target" id="vfpga__hw_8h_1a9efd871b1073e77ca9d3dc142dc3669c"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">clear_irq</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv49clear_irqP9vfpga_dev" title="Link to this definition"></a><br /></dt>
<dd><p>Resets the IRQ registers in hardware. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> – vFPGA char device </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411restart_mmuP9vfpga_devb7int32_t">
<span id="_CPPv311restart_mmuP9vfpga_devb7int32_t"></span><span id="_CPPv211restart_mmuP9vfpga_devb7int32_t"></span><span id="restart_mmu__vfpga_devP.b.int32_t"></span><span class="target" id="vfpga__hw_8h_1ae63cb49fe30b18e0f168b061aa8f74c0"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">restart_mmu</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">write</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ctid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411restart_mmuP9vfpga_devb7int32_t" title="Link to this definition"></a><br /></dt>
<dd><p>Restarts the MMU, by signaling a page fault has correctly been handled. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>write</strong> – write operation (true) or read operation (false) </p></li>
<li><p><strong>ctid</strong> – Coyote thread ID </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420invalidate_tlb_entryP9vfpga_dev8uint64_t8uint32_t7int32_tb">
<span id="_CPPv320invalidate_tlb_entryP9vfpga_dev8uint64_t8uint32_t7int32_tb"></span><span id="_CPPv220invalidate_tlb_entryP9vfpga_dev8uint64_t8uint32_t7int32_tb"></span><span id="invalidate_tlb_entry__vfpga_devP.uint64_t.uint32_t.int32_t.b"></span><span class="target" id="vfpga__hw_8h_1a3f8f13adeaa73204b9940bd7dcaa89ef"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">invalidate_tlb_entry</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vaddr</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_pages</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">hpid</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">last</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420invalidate_tlb_entryP9vfpga_dev8uint64_t8uint32_t7int32_tb" title="Link to this definition"></a><br /></dt>
<dd><p>Invalidate a TLB entry. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>vaddr</strong> – starting virtual address of the buffer to be invalidated </p></li>
<li><p><strong>n_pages</strong> – number of consecutive pages to be invalidated </p></li>
<li><p><strong>hpid</strong> – host process ID </p></li>
<li><p><strong>last</strong> – is this the last page of the buffer to be invalidated (equivalent to a tlast in an AXI stream) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415change_tlb_lockP9vfpga_dev">
<span id="_CPPv315change_tlb_lockP9vfpga_dev"></span><span id="_CPPv215change_tlb_lockP9vfpga_dev"></span><span id="change_tlb_lock__vfpga_devP"></span><span class="target" id="vfpga__hw_8h_1a0544d51e5e37be9692aacb3d982deac3"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">change_tlb_lock</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415change_tlb_lockP9vfpga_dev" title="Link to this definition"></a><br /></dt>
<dd><p>Locks or unlocks the TLB, potentially prevent new entries (if locked) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> – vFPGA char device </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418create_tlb_mappingP9vfpga_devP12tlb_metadata8uint64_t8uint64_t7int32_t7int32_t5pid_t">
<span id="_CPPv318create_tlb_mappingP9vfpga_devP12tlb_metadata8uint64_t8uint64_t7int32_t7int32_t5pid_t"></span><span id="_CPPv218create_tlb_mappingP9vfpga_devP12tlb_metadata8uint64_t8uint64_t7int32_t7int32_t5pid_t"></span><span id="create_tlb_mapping__vfpga_devP.tlb_metadataP.uint64_t.uint64_t.int32_t.int32_t.pid_t"></span><span class="target" id="vfpga__hw_8h_1a9d6cee49816eb18b6b901dbca9b2173d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_tlb_mapping</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">tlb_metadata</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">tlb_meta</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vaddr</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">physical_address</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">host</span></span>, <span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ctid</span></span>, <span class="n"><span class="pre">pid_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">hpid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418create_tlb_mappingP9vfpga_devP12tlb_metadata8uint64_t8uint64_t7int32_t7int32_t5pid_t" title="Link to this definition"></a><br /></dt>
<dd><p>Create a TLB mapping. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>tlb_meta</strong> – helper struct, containing TLB information (page size &amp; shift, key size &amp; shift etc.) </p></li>
<li><p><strong>vaddr</strong> – buffer virtual address </p></li>
<li><p><strong>physical_address</strong> – buffer physical address </p></li>
<li><p><strong>host</strong> – does the buffer reside in host memory (1) or in card memory (0) </p></li>
<li><p><strong>ctid</strong> – Coyote thread ID </p></li>
<li><p><strong>hpid</strong> – Host process ID </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420create_tlb_unmappingP9vfpga_devP12tlb_metadata8uint64_t5pid_t">
<span id="_CPPv320create_tlb_unmappingP9vfpga_devP12tlb_metadata8uint64_t5pid_t"></span><span id="_CPPv220create_tlb_unmappingP9vfpga_devP12tlb_metadata8uint64_t5pid_t"></span><span id="create_tlb_unmapping__vfpga_devP.tlb_metadataP.uint64_t.pid_t"></span><span class="target" id="vfpga__hw_8h_1a36f5ec4d040c0febe114f8a6e89eb015"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_tlb_unmapping</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">tlb_metadata</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">tlb_meta</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vaddr</span></span>, <span class="n"><span class="pre">pid_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">hpid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420create_tlb_unmappingP9vfpga_devP12tlb_metadata8uint64_t5pid_t" title="Link to this definition"></a><br /></dt>
<dd><p>Unmap TLB entry. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>tlb_meta</strong> – helper struct, containing TLB information (page size &amp; shift, key size &amp; shift etc.) </p></li>
<li><p><strong>vaddr</strong> – buffer virtual address </p></li>
<li><p><strong>hpid</strong> – Host process ID </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419trigger_dma_offloadP9vfpga_devP8uint64_tP8uint64_t8uint32_tb">
<span id="_CPPv319trigger_dma_offloadP9vfpga_devP8uint64_tP8uint64_t8uint32_tb"></span><span id="_CPPv219trigger_dma_offloadP9vfpga_devP8uint64_tP8uint64_t8uint32_tb"></span><span id="trigger_dma_offload__vfpga_devP.uint64_tP.uint64_tP.uint32_t.b"></span><span class="target" id="vfpga__hw_8h_1a3993f5f47329350001f11d1beb0a26c9"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">trigger_dma_offload</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">host_address</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">card_address</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_pages</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">huge</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419trigger_dma_offloadP9vfpga_devP8uint64_tP8uint64_t8uint32_tb" title="Link to this definition"></a><br /></dt>
<dd><p>Triggers DMA off-load from host memory to card memory (asynchronous) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>host_address</strong> – - virtual address of the buffer on the host to be off-loaded </p></li>
<li><p><strong>card_address</strong> – - target virtual address on the card </p></li>
<li><p><strong>n_pages</strong> – - number of pages in the buffer to be off-loaded </p></li>
<li><p><strong>huge</strong> – - whether the buffer is using hugepages or regular pages </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416trigger_dma_syncP9vfpga_devP8uint64_tP8uint64_t8uint32_tb">
<span id="_CPPv316trigger_dma_syncP9vfpga_devP8uint64_tP8uint64_t8uint32_tb"></span><span id="_CPPv216trigger_dma_syncP9vfpga_devP8uint64_tP8uint64_t8uint32_tb"></span><span id="trigger_dma_sync__vfpga_devP.uint64_tP.uint64_tP.uint32_t.b"></span><span class="target" id="vfpga__hw_8h_1a5730bcd175a9bd85813e25aef3f53db8"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">trigger_dma_sync</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">host_address</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">card_address</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_pages</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">huge</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416trigger_dma_syncP9vfpga_devP8uint64_tP8uint64_t8uint32_tb" title="Link to this definition"></a><br /></dt>
<dd><p>Triggers DMA sync from card memory to host memory (asynchronous) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>host_address</strong> – - target virtual address of the buffer on the host </p></li>
<li><p><strong>card_address</strong> – - virtual address of the buffer on the card </p></li>
<li><p><strong>n_pages</strong> – - number of pages in the buffer to be synced </p></li>
<li><p><strong>huge</strong> – - whether the buffer is using hugepages or regular pages </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417alloc_card_memoryP9vfpga_devP8uint64_t8uint32_tb">
<span id="_CPPv317alloc_card_memoryP9vfpga_devP8uint64_t8uint32_tb"></span><span id="_CPPv217alloc_card_memoryP9vfpga_devP8uint64_t8uint32_tb"></span><span id="alloc_card_memory__vfpga_devP.uint64_tP.uint32_t.b"></span><span class="target" id="vfpga__hw_8h_1a74785c516591e223de78ea3daf9916a8"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">alloc_card_memory</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">card_physical_address</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_pages</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">huge</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417alloc_card_memoryP9vfpga_devP8uint64_t8uint32_tb" title="Link to this definition"></a><br /></dt>
<dd><p>Allocates memory on the card’s HBM or DDR memory and updates the card_physical_address parameter with the allocated addresses. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>card_physical_address</strong> – initially null/empty, set by the function to reflect the physical address of the allocated pages </p></li>
<li><p><strong>n_pages</strong> – number of pages to be allocated </p></li>
<li><p><strong>huge</strong> – whether the memory is using hugepages or regular pages </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>whether the allocation was successful; can fail if there is insufficient space on the card </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416free_card_memoryP9vfpga_devP8uint64_t8uint32_tb">
<span id="_CPPv316free_card_memoryP9vfpga_devP8uint64_t8uint32_tb"></span><span id="_CPPv216free_card_memoryP9vfpga_devP8uint64_t8uint32_tb"></span><span id="free_card_memory__vfpga_devP.uint64_tP.uint32_t.b"></span><span class="target" id="vfpga__hw_8h_1ab36cfb218a65af5fff62c41b9624197d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">free_card_memory</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">card_physical_address</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_pages</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">huge</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416free_card_memoryP9vfpga_devP8uint64_t8uint32_tb" title="Link to this definition"></a><br /></dt>
<dd><p>Release memory on the card; opposite of the above alloc_card_memory function. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vFPGA char device </p></li>
<li><p><strong>card_physical_address</strong> – list of pages allocated on the card’s memory and their corresponding physical addresses </p></li>
<li><p><strong>n_pages</strong> – number of pages to be freed </p></li>
<li><p><strong>huge</strong> – whether the memory to be freed is using hugepages or regular pages </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</section>
<section id="vfpga-isr-h">
<h2>vfpga_isr.h<a class="headerlink" href="#vfpga-isr-h" title="Link to this heading"></a></h2>
<p>vFPGA interrupts (page faults, invalidations, user interrupts etc.) </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv49vfpga_isriPv">
<span id="_CPPv39vfpga_isriPv"></span><span id="_CPPv29vfpga_isriPv"></span><span id="vfpga_isr__i.voidP"></span><span class="target" id="vfpga__isr_8h_1a6e8f9dc674beaf821ccdd828c4b56f30"></span><span class="n"><span class="pre">irqreturn_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vfpga_isr</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">irq</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv49vfpga_isriPv" title="Link to this definition"></a><br /></dt>
<dd><p>Top-level vFPGA interrupt routine; registered during set-up in msix_irq_setup(…) </p>
<p>Catches interrupts issued by the vFPGA (sent via XDMA and PCIe) and calls the appropriate callback method Interrupts, in the order of importance are:<ol class="loweralpha simple">
<li><p>Completed DMA offloads/syncs</p></li>
<li><p>Completed TLB invalidation</p></li>
<li><p>Page fault</p></li>
<li><p>User interrupts (notification)</p></li>
</ol>
</p>
<p>For more details, refer to: Chapter 3.1.3.5 Interrupts in Abstractions for Modern Heterogeneous Systems (2024), Dario Korlija</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>irq</strong> – Interrupt type </p></li>
<li><p><strong>d</strong> – Generic pointer to a Linux device; internally parsed into a vfpga_dev pointer </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420vfpga_notify_handlerP11work_struct">
<span id="_CPPv320vfpga_notify_handlerP11work_struct"></span><span id="_CPPv220vfpga_notify_handlerP11work_struct"></span><span id="vfpga_notify_handler__work_structP"></span><span class="target" id="vfpga__isr_8h_1a9804910cd8cf701ae81e7def5370c480"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vfpga_notify_handler</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">work_struct</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">work</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420vfpga_notify_handlerP11work_struct" title="Link to this definition"></a><br /></dt>
<dd><p>Handles user interupts (notifications) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420vfpga_pfault_handlerP11work_struct">
<span id="_CPPv320vfpga_pfault_handlerP11work_struct"></span><span id="_CPPv220vfpga_pfault_handlerP11work_struct"></span><span id="vfpga_pfault_handler__work_structP"></span><span class="target" id="vfpga__isr_8h_1aefb759d5abc5ae89b9dbfe4fc14b1fee"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vfpga_pfault_handler</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">work_struct</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">work</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420vfpga_pfault_handlerP11work_struct" title="Link to this definition"></a><br /></dt>
<dd><p>Handles vFPGA page faults, by invalidating and updating TLB; migrating data where required. </p>
</dd></dl>

</div>
</section>
<section id="vfpga-ops-h">
<h2>vfpga_ops.h<a class="headerlink" href="#vfpga-ops-h" title="Link to this heading"></a></h2>
<p>Standard device operations for the vfpga_dev char device: open, release, ioctl and memory map (mmap) </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414vfpga_dev_openP5inodeP4file">
<span id="_CPPv314vfpga_dev_openP5inodeP4file"></span><span id="_CPPv214vfpga_dev_openP5inodeP4file"></span><span id="vfpga_dev_open__inodeP.fileP"></span><span class="target" id="vfpga__ops_8h_1a828452e9ea0b1ce52b521460886ba6f7"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vfpga_dev_open</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv414vfpga_dev_openP5inodeP4file" title="vfpga_dev_open::inode"><span class="n"><span class="pre">inode</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">inode</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv414vfpga_dev_openP5inodeP4file" title="vfpga_dev_open::file"><span class="n"><span class="pre">file</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">file</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414vfpga_dev_openP5inodeP4file" title="Link to this definition"></a><br /></dt>
<dd><p>vfpga_dev open char device </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417vfpga_dev_releaseP5inodeP4file">
<span id="_CPPv317vfpga_dev_releaseP5inodeP4file"></span><span id="_CPPv217vfpga_dev_releaseP5inodeP4file"></span><span id="vfpga_dev_release__inodeP.fileP"></span><span class="target" id="vfpga__ops_8h_1a7f3d66eaf01184919c860308df27426f"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vfpga_dev_release</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv417vfpga_dev_releaseP5inodeP4file" title="vfpga_dev_release::inode"><span class="n"><span class="pre">inode</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">inode</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv417vfpga_dev_releaseP5inodeP4file" title="vfpga_dev_release::file"><span class="n"><span class="pre">file</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">file</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417vfpga_dev_releaseP5inodeP4file" title="Link to this definition"></a><br /></dt>
<dd><p>vfpga_dev release (close) char device </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415vfpga_dev_ioctlP4filejm">
<span id="_CPPv315vfpga_dev_ioctlP4filejm"></span><span id="_CPPv215vfpga_dev_ioctlP4filejm"></span><span id="vfpga_dev_ioctl__fileP.unsigned-i.unsigned-l"></span><span class="target" id="vfpga__ops_8h_1a98c68720bc0230e3d6140a53c115ae55"></span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vfpga_dev_ioctl</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv415vfpga_dev_ioctlP4filejm" title="vfpga_dev_ioctl::file"><span class="n"><span class="pre">file</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">file</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cmd</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">arg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415vfpga_dev_ioctlP4filejm" title="Link to this definition"></a><br /></dt>
<dd><p>vfpga_dev IOCTL calls </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414vfpga_dev_mmapP4fileP14vm_area_struct">
<span id="_CPPv314vfpga_dev_mmapP4fileP14vm_area_struct"></span><span id="_CPPv214vfpga_dev_mmapP4fileP14vm_area_struct"></span><span id="vfpga_dev_mmap__fileP.vm_area_structP"></span><span class="target" id="vfpga__ops_8h_1afac02e8aa2bc86dde0022053b82cc442"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vfpga_dev_mmap</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv414vfpga_dev_mmapP4fileP14vm_area_struct" title="vfpga_dev_mmap::file"><span class="n"><span class="pre">file</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">file</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vm_area_struct</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">vma</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414vfpga_dev_mmapP4fileP14vm_area_struct" title="Link to this definition"></a><br /></dt>
<dd><p>vfpga_dev memory map; maps user control region, vFPGA config and writeback regions </p>
</dd></dl>

</div>
</section>
<section id="vfpga-uisr-h">
<h2>vfpga_uisr.h<a class="headerlink" href="#vfpga-uisr-h" title="Link to this heading"></a></h2>
<p>vFPGA user interrupts (notifications) </p>
<p>Methods to register user interrupt (notification) callbacks, as requested by the user In Coyote, user interrupts (notifications) are linked to a Coyote thread, through its ID (ctid) Therefore, there can be multiple interrupt callbacks for one vFPGA, since it’s possible to have more than one Coyote thread per vFPGA For more details, see Example 3: Multi-threading and Example 4: User interrupts</p>
<p>To handle interrupts, Coyote uses eventfd, a Linux kernel mechanism for event signalling eventfd can be used to communicate events between the kernel- and the user-space, or between processes In Coyote, an eventfd is created from the user-space and registered by the driver using the method vfpga_register_eventfd Then, when an interrupt from the FPGA is picked up by the driver (see vfpga_isr.c), the driver writes to the appropariate eventfd The user-space software polls on the same eventfd, and, when a change is detected, executes the appropriate callback (see sw/bThread.cpp) </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422vfpga_register_eventfdP9vfpga_devii">
<span id="_CPPv322vfpga_register_eventfdP9vfpga_devii"></span><span id="_CPPv222vfpga_register_eventfdP9vfpga_devii"></span><span id="vfpga_register_eventfd__vfpga_devP.i.i"></span><span class="target" id="vfpga__uisr_8h_1ae36a6d84906cdf055f262f7d1e76e2cb"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vfpga_register_eventfd</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ctid</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">eventfd</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422vfpga_register_eventfdP9vfpga_devii" title="Link to this definition"></a><br /></dt>
<dd><p>Registers an eventfd for a given Coyote thread and vFPGA device. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vfpga_dev for which the eventfd should be registered </p></li>
<li><p><strong>ctid</strong> – Coyote thread ID (obtained from user-space) </p></li>
<li><p><strong>eventfd</strong> – eventfd file descriptor, as created in the user-space (see sw/bThread.cpp) </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>whether eventfd was successfully registered </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424vfpga_unregister_eventfdP9vfpga_devi">
<span id="_CPPv324vfpga_unregister_eventfdP9vfpga_devi"></span><span id="_CPPv224vfpga_unregister_eventfdP9vfpga_devi"></span><span id="vfpga_unregister_eventfd__vfpga_devP.i"></span><span class="target" id="vfpga__uisr_8h_1a4a48c7387bef4b6c6a288e9722fc81b1"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vfpga_unregister_eventfd</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vfpga_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ctid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424vfpga_unregister_eventfdP9vfpga_devi" title="Link to this definition"></a><br /></dt>
<dd><p>Unregisters an eventfd for a given Coyote thread and vFPGA device. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – vfpga_dev for which the eventfd should be released </p></li>
<li><p><strong>ctid</strong> – Coyote thread ID of the eventfd which should be released </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</section>
<section id="reconfig-hw-h">
<h2>reconfig_hw.h<a class="headerlink" href="#reconfig-hw-h" title="Link to this heading"></a></h2>
<p>Low-level hardware functionality to trigger run-time reconfiguration of the FPGA. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417reconfigure_startP12reconfig_dev8uint64_t8uint64_t5pid_t8uint32_t">
<span id="_CPPv317reconfigure_startP12reconfig_dev8uint64_t8uint64_t5pid_t8uint32_t"></span><span id="_CPPv217reconfigure_startP12reconfig_dev8uint64_t8uint64_t5pid_t8uint32_t"></span><span id="reconfigure_start__reconfig_devP.uint64_t.uint64_t.pid_t.uint32_t"></span><span class="target" id="reconfig__hw_8h_1a939fb54e18aa61ab8ea38f92bd7fdf10"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reconfigure_start</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">reconfig_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vaddr</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">len</span></span>, <span class="n"><span class="pre">pid_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">pid</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">crid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417reconfigure_startP12reconfig_dev8uint64_t8uint64_t5pid_t8uint32_t" title="Link to this definition"></a><br /></dt>
<dd><p>Triggers the reconfiguration process. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – reconfig_device to be reconfigured (corresponding to the actual physical FPGA we want to reconfigure) </p></li>
<li><p><strong>vaddr</strong> – bitstream buffer virtual address; obtained from alloc_buffer and mmap </p></li>
<li><p><strong>pid</strong> – host process ID </p></li>
<li><p><strong>crid</strong> – configuration ID </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>reconfiguration started successfuly or not </p>
</dd>
</dl>
</dd></dl>

</div>
</section>
<section id="reconfig-isr-h">
<h2>reconfig_isr.h<a class="headerlink" href="#reconfig-isr-h" title="Link to this heading"></a></h2>
<p>Reconfiguration interrupt management; picking up interrupts when reconfiguration is complete. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412reconfig_isriPv">
<span id="_CPPv312reconfig_isriPv"></span><span id="_CPPv212reconfig_isriPv"></span><span id="reconfig_isr__i.voidP"></span><span class="target" id="reconfig__isr_8h_1a577bc84baba7137e26298d2a619c3345"></span><span class="n"><span class="pre">irqreturn_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reconfig_isr</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">irq</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412reconfig_isriPv" title="Link to this definition"></a><br /></dt>
<dd><p>Handles incoming interrupts related to reconfiguration. </p>
<p>A reconfiguration interrupt issued by the FPGA corresponds to reconfiguration being completed successfuly Once picked up by this function, it sets the wait_rcnfg variable to SET, which is polled on during IOCTL_RECONFIGURE_(SHELL|APP) Finally, it clears the memory-mapped interrupt register in the FPGA</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>irq</strong> – interrupt value </p></li>
<li><p><strong>dev</strong> – pointer to the reconfiguration device being reconfigured </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>IRQ_HANDLED, indicating interrupt has been acknowledged </p>
</dd>
</dl>
</dd></dl>

</div>
</section>
<section id="reconfig-mem-h">
<h2>reconfig_mem.h<a class="headerlink" href="#reconfig-mem-h" title="Link to this heading"></a></h2>
<p>Memory management for reconfiguration: allocating and releasing memory to hold partial bitstreams. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421alloc_reconfig_bufferP12reconfig_devm5pid_t8uint32_t">
<span id="_CPPv321alloc_reconfig_bufferP12reconfig_devm5pid_t8uint32_t"></span><span id="_CPPv221alloc_reconfig_bufferP12reconfig_devm5pid_t8uint32_t"></span><span id="alloc_reconfig_buffer__reconfig_devP.unsigned-l.pid_t.uint32_t"></span><span class="target" id="reconfig__mem_8h_1a3dcca9f5797eb0036307907c4e9707aa"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">alloc_reconfig_buffer</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">reconfig_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_pages</span></span>, <span class="n"><span class="pre">pid_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">pid</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">crid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421alloc_reconfig_bufferP12reconfig_devm5pid_t8uint32_t" title="Link to this definition"></a><br /></dt>
<dd><p>Allocates host-side, kernel-space reconfiguration buffers. </p>
<p>In order for partial bitstreams to be loaded onto the FPGA, they need to be written to the ICAP from the driver via PCIe and the XDMA core This function allocates a buffer of sufficient size to hold a partial bitstream for reconfiguration Following this function, the buffer is mapped to the user-space using an mmap call (reconfig_ops.h) Finally, the partial bitstream can then be loaded into this buffer and used to trigger reconfiguration</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – reconfig_device for which the bitstream buffer should be allocated </p></li>
<li><p><strong>n_pages</strong> – number of hugepages required to hold the bitsream; calculated in user-space </p></li>
<li><p><strong>pid</strong> – host process ID </p></li>
<li><p><strong>crid</strong> – configuration ID (uniquely identifies the shell bitstream to be loaded) </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>whether target memory allocation completed successfully </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420free_reconfig_bufferP12reconfig_dev8uint64_t5pid_t8uint32_t">
<span id="_CPPv320free_reconfig_bufferP12reconfig_dev8uint64_t5pid_t8uint32_t"></span><span id="_CPPv220free_reconfig_bufferP12reconfig_dev8uint64_t5pid_t8uint32_t"></span><span id="free_reconfig_buffer__reconfig_devP.uint64_t.pid_t.uint32_t"></span><span class="target" id="reconfig__mem_8h_1a82af4510c7385765d45c88e12a02164e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">free_reconfig_buffer</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">reconfig_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vaddr</span></span>, <span class="n"><span class="pre">pid_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">pid</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">crid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420free_reconfig_bufferP12reconfig_dev8uint64_t5pid_t8uint32_t" title="Link to this definition"></a><br /></dt>
<dd><p>De-allocates host-side, kernel-space reconfiguration buffer. </p>
<p>Performs the opposite of the function above; to be used when reconfiguration is complete</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – reconfig_device for which the bitstream buffer should be allocated </p></li>
<li><p><strong>vaddr</strong> – buffer virtual address </p></li>
<li><p><strong>pid</strong> – host process ID </p></li>
<li><p><strong>crid</strong> – configuration ID </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>always 0; check reconfig_mem.c for explanation </p>
</dd>
</dl>
</dd></dl>

</div>
</section>
<section id="reconfig-ops-h">
<h2>reconfig_ops.h<a class="headerlink" href="#reconfig-ops-h" title="Link to this heading"></a></h2>
<p>Standard device operations for the reconfig_dev char device: open, release, ioctl and memory map (mmap) </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417reconfig_dev_openP5inodeP4file">
<span id="_CPPv317reconfig_dev_openP5inodeP4file"></span><span id="_CPPv217reconfig_dev_openP5inodeP4file"></span><span id="reconfig_dev_open__inodeP.fileP"></span><span class="target" id="reconfig__ops_8h_1a4c34b384ea124987dfaec985d86f05d6"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reconfig_dev_open</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv417reconfig_dev_openP5inodeP4file" title="reconfig_dev_open::inode"><span class="n"><span class="pre">inode</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">inode</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv417reconfig_dev_openP5inodeP4file" title="reconfig_dev_open::file"><span class="n"><span class="pre">file</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">file</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417reconfig_dev_openP5inodeP4file" title="Link to this definition"></a><br /></dt>
<dd><p>reconfig_dev open char device </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420reconfig_dev_releaseP5inodeP4file">
<span id="_CPPv320reconfig_dev_releaseP5inodeP4file"></span><span id="_CPPv220reconfig_dev_releaseP5inodeP4file"></span><span id="reconfig_dev_release__inodeP.fileP"></span><span class="target" id="reconfig__ops_8h_1a85a2af8b1de7a5c4b2b51fc869eebd64"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reconfig_dev_release</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv420reconfig_dev_releaseP5inodeP4file" title="reconfig_dev_release::inode"><span class="n"><span class="pre">inode</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">inode</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv420reconfig_dev_releaseP5inodeP4file" title="reconfig_dev_release::file"><span class="n"><span class="pre">file</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">file</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420reconfig_dev_releaseP5inodeP4file" title="Link to this definition"></a><br /></dt>
<dd><p>reconfig_dev release (close) char device </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418reconfig_dev_ioctlP4filejm">
<span id="_CPPv318reconfig_dev_ioctlP4filejm"></span><span id="_CPPv218reconfig_dev_ioctlP4filejm"></span><span id="reconfig_dev_ioctl__fileP.unsigned-i.unsigned-l"></span><span class="target" id="reconfig__ops_8h_1a59bf77cd649b035650c65c845882a80b"></span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reconfig_dev_ioctl</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv418reconfig_dev_ioctlP4filejm" title="reconfig_dev_ioctl::file"><span class="n"><span class="pre">file</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">file</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cmd</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">arg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418reconfig_dev_ioctlP4filejm" title="Link to this definition"></a><br /></dt>
<dd><p>reconfig_dev IOCTL calls </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417reconfig_dev_mmapP4fileP14vm_area_struct">
<span id="_CPPv317reconfig_dev_mmapP4fileP14vm_area_struct"></span><span id="_CPPv217reconfig_dev_mmapP4fileP14vm_area_struct"></span><span id="reconfig_dev_mmap__fileP.vm_area_structP"></span><span class="target" id="reconfig__ops_8h_1a4898f72120b001a5fa216b70d651c84f"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reconfig_dev_mmap</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv417reconfig_dev_mmapP4fileP14vm_area_struct" title="reconfig_dev_mmap::file"><span class="n"><span class="pre">file</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">file</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">vm_area_struct</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">vma</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417reconfig_dev_mmapP4fileP14vm_area_struct" title="Link to this definition"></a><br /></dt>
<dd><p>reconfig_dev memory map; maps pages allocated using IOCTL_ALLOC_PR_BUFF from kernel space to user space </p>
</dd></dl>

</div>
</section>
<section id="pci-util-h">
<h2>pci_util.h<a class="headerlink" href="#pci-util-h" title="Link to this heading"></a></h2>
<p>Coyote PCI utility functions. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv49build_u328uint32_t8uint32_t">
<span id="_CPPv39build_u328uint32_t8uint32_t"></span><span id="_CPPv29build_u328uint32_t8uint32_t"></span><span id="build_u32__uint32_t.uint32_t"></span><span class="target" id="pci__util_8h_1afdb4a89ae9f055c425ab2aff3cd37809"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">build_u32</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">hi</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">lo</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv49build_u328uint32_t8uint32_t" title="Link to this definition"></a><br /></dt>
<dd><p>Utility functions, concatenates two 16-bit values into a single 32-bit value. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421pci_enable_capabilityP7pci_devi">
<span id="_CPPv321pci_enable_capabilityP7pci_devi"></span><span id="_CPPv221pci_enable_capabilityP7pci_devi"></span><span id="pci_enable_capability__pci_devP.i"></span><span class="target" id="pci__util_8h_1a5cbdd11e5ec12c78c9a25a55167e1440"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pci_enable_capability</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pdev</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cmd</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421pci_enable_capabilityP7pci_devi" title="Link to this definition"></a><br /></dt>
<dd><p>Enables a specific PCIe capability for the device. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdev</strong> – Pointer to the PCI device structure </p></li>
<li><p><strong>capability</strong> – Capability to enable </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412msix_capableP7pci_dev">
<span id="_CPPv312msix_capableP7pci_dev"></span><span id="_CPPv212msix_capableP7pci_dev"></span><span id="msix_capable__pci_devP"></span><span class="target" id="pci__util_8h_1aae480187c61297aba0ee1987af31bd4d"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">msix_capable</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pdev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412msix_capableP7pci_dev" title="Link to this definition"></a><br /></dt>
<dd><p>Checks if the PCI device supports MSI-X. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pdev</strong> – Pointer to the PCI device structure. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">true</span></code> if MSI-X is supported, <code class="docutils literal notranslate"><span class="pre">false</span></code> otherwise. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416build_vector_reg8uint32_t8uint32_t8uint32_t8uint32_t">
<span id="_CPPv316build_vector_reg8uint32_t8uint32_t8uint32_t8uint32_t"></span><span id="_CPPv216build_vector_reg8uint32_t8uint32_t8uint32_t8uint32_t"></span><span id="build_vector_reg__uint32_t.uint32_t.uint32_t.uint32_t"></span><span class="target" id="pci__util_8h_1aa1f4a2c6e5a3cac5cd93a226668cd93b"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">build_vector_reg</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">a</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">b</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">c</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">d</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416build_vector_reg8uint32_t8uint32_t8uint32_t8uint32_t" title="Link to this definition"></a><br /></dt>
<dd><p>Utility function, constructs a 32-bit MSI-X vector register value. </p>
<p>This function packs four 5-bit fields (a, b, c, d) into a single 32-bit value. Each field represents an MSI-X table entry index 5 bit-values are used, per the XDMA specification [PG195 (v4.1)], Table 90 onwards</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – The first 5-bit field (bits 0–4) </p></li>
<li><p><strong>b</strong> – The second 5-bit field (bits 8–12) </p></li>
<li><p><strong>c</strong> – The third 5-bit field (bits 16–20) </p></li>
<li><p><strong>d</strong> – The fourth 5-bit field (bits 24–28) </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 32-bit value representing the packed MSI-X vector register </p>
</dd>
</dl>
</dd></dl>

</div>
</section>
<section id="pci-xdma-h">
<h2>pci_xdma.h<a class="headerlink" href="#pci-xdma-h" title="Link to this heading"></a></h2>
<p>Contains functions for loading and setting up the Coyote driver on PCI platforms with the XDMA core. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416assign_device_idP15bus_driver_data">
<span id="_CPPv316assign_device_idP15bus_driver_data"></span><span id="_CPPv216assign_device_idP15bus_driver_data"></span><span id="assign_device_id__bus_driver_dataP"></span><span class="target" id="pci__xdma_8h_1a96691ee05ba8c2aa547fff9f1ee6724b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">assign_device_id</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416assign_device_idP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Assign a unique ID to each Coyote-enabled FPGA card and set the unique device name. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423vfpga_interrupts_enableP15bus_driver_data">
<span id="_CPPv323vfpga_interrupts_enableP15bus_driver_data"></span><span id="_CPPv223vfpga_interrupts_enableP15bus_driver_data"></span><span id="vfpga_interrupts_enable__bus_driver_dataP"></span><span class="target" id="pci__xdma_8h_1aa76a32a89bfbbf98108f9caafd82a5fb"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vfpga_interrupts_enable</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423vfpga_interrupts_enableP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Enables interrupts issued from vFPGAs. </p>
<p>Interrupts issued through the XDMA core must be enabled By writing to the IRQ Block User Interrupt Enable Mask W1S (0x08) register W1S means “Write 1 to Set”, which means that bits set to 1 in the mask Will enable the corresponding interrupts For more information, refer to the XDMA specification [PG195 (v4.1)] In particular, page 59 onwards, Table 78 and Table 81 for this function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424vfpga_interrupts_disableP15bus_driver_data">
<span id="_CPPv324vfpga_interrupts_disableP15bus_driver_data"></span><span id="_CPPv224vfpga_interrupts_disableP15bus_driver_data"></span><span id="vfpga_interrupts_disable__bus_driver_dataP"></span><span class="target" id="pci__xdma_8h_1a23afac6b14e272e7b271891274cf4d0e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vfpga_interrupts_disable</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424vfpga_interrupts_disableP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Disables interrupts issued from vFPGAs. </p>
<p>Interrupts issued through the XDMA core can be disabled (for e.g., when removing the driver) To do so, it’s necessary to write to the IRQ Block User Interrupt Enable Mask W1C (0x12) register W1C means “Write 1 to Clear”, which means that bits set to 1 in the mask Will disable the corresponding interrupts For more information, refer to the XDMA specification [PG195 (v4.1)] In particular, page 59 onwards, Table 78 and Table 82 for this function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv425reconfig_interrupt_enableP15bus_driver_data">
<span id="_CPPv325reconfig_interrupt_enableP15bus_driver_data"></span><span id="_CPPv225reconfig_interrupt_enableP15bus_driver_data"></span><span id="reconfig_interrupt_enable__bus_driver_dataP"></span><span class="target" id="pci__xdma_8h_1ad0d810dfb74beaf570ff5ff003f77c18"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reconfig_interrupt_enable</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425reconfig_interrupt_enableP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Enables interrupts issued for reconfiguration. </p>
<p>Interrupts issued through the XDMA core must be enabled By writing to the IRQ Block User Interrupt Enable Mask W1S (0x08) register The method is the same as for vFPGAs (above), but the mask is different More informaction in the XDMA specification [PG195 (v4.1)], p59 onwards, Tables 78 and 81</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv426reconfig_interrupt_disableP15bus_driver_data">
<span id="_CPPv326reconfig_interrupt_disableP15bus_driver_data"></span><span id="_CPPv226reconfig_interrupt_disableP15bus_driver_data"></span><span id="reconfig_interrupt_disable__bus_driver_dataP"></span><span class="target" id="pci__xdma_8h_1a4938d90ad83416443f64a4dce175df37"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reconfig_interrupt_disable</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv426reconfig_interrupt_disableP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Disables interrupts used for reconfiguration. </p>
<p>Similar implemenation as in vfpga_interrupts_disable, with a different For more information, see above functions and the XDMA specification, p59 onwards, Tables 78 and 82</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415read_interruptsP15bus_driver_data">
<span id="_CPPv315read_interruptsP15bus_driver_data"></span><span id="_CPPv215read_interruptsP15bus_driver_data"></span><span id="read_interrupts__bus_driver_dataP"></span><span class="target" id="pci__xdma_8h_1ac7847effd8cc1ac5080f475ccdbbc510"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">read_interrupts</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415read_interruptsP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Reads the interrupts registers from the XDMA core. </p>
<p>Util function which can be used for debugging but also to flush previous register values For more details on the registers values, refer to the XDMA specification [PG195 (v4.1)], Tables 78, 86, 87 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>32-bit value containing the interrupts requests; low 16 are user, top 16 are channel (unused in Coyote)</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418write_msix_vectorsP15bus_driver_data">
<span id="_CPPv318write_msix_vectorsP15bus_driver_data"></span><span id="_CPPv218write_msix_vectorsP15bus_driver_data"></span><span id="write_msix_vectors__bus_driver_dataP"></span><span class="target" id="pci__xdma_8h_1aa4ee4aee1d2c9aceae89d2e93a192178"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">write_msix_vectors</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418write_msix_vectorsP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Writes MSI-X vectors to the XDMA configuration registers; per Table 90 in the XDMA specification. </p>
<p>MSI-X vectors are required to uniquely identify an interrupt source and therefore call the correct ISR handler function. In Coyote, we write one vector for each vFPGA device and one for the reconfiguration process In total, there are at most 15 (vFPGA) interrupts and 1 (reconfiguration) interrupt, hence 16 vectors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv49irq_setupP15bus_driver_dataP7pci_devb">
<span id="_CPPv39irq_setupP15bus_driver_dataP7pci_devb"></span><span id="_CPPv29irq_setupP15bus_driver_dataP7pci_devb"></span><span id="irq_setup__bus_driver_dataP.pci_devP.b"></span><span class="target" id="pci__xdma_8h_1a0ca62c62918e7964202662208f43f561"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">irq_setup</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pdev</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">enable_reconfig_irq</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv49irq_setupP15bus_driver_dataP7pci_devb" title="Link to this definition"></a><br /></dt>
<dd><p>Sets up Coyote IRQs for vfpga and reconfig devices. </p>
<p>This function initializes the MSI-X interrupt vectors for the device and associates them with the appropriate interrupt handler functions (vfpga_isr, reconfig_isr).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>enable_reconfig_irq is used to determine whether to set up the reconfiguration interrupt. Additionally, it is used to indicate the “first” set-up of the Coyote driver, when the bitstram is loaded using the Vivado Hardware Manager. When this happens, the MSI-X vectors need to be written to the XDMA configuration registers using the write_msix_vectors function. However, this function is also called after shell_pci_init, which is used when dynamically reconfiguring the shell Then, there is no need to write the MSI-X vectors again, as they are already set up (the XDMA core stays online during shell reconfiguration). However, the IRQ vectors need to be re-initialized for the vFPGA devices (but not for the reconfiguration device). </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p></li>
<li><p><strong>pdev</strong> – Pointer to the PCI device structure associated with the Coyote device. </p></li>
<li><p><strong>enable_reconfig_irq</strong> – Boolean flag to enable reconfiguration interrupts. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success, negative error code on failure.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412irq_teardownP15bus_driver_datab">
<span id="_CPPv312irq_teardownP15bus_driver_datab"></span><span id="_CPPv212irq_teardownP15bus_driver_datab"></span><span id="irq_teardown__bus_driver_dataP.b"></span><span class="target" id="pci__xdma_8h_1a9a9a1f6f158c97b254e195f072b84aeb"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">irq_teardown</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">enable_reconfig_irq</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412irq_teardownP15bus_driver_datab" title="Link to this definition"></a><br /></dt>
<dd><p>Removes previously set-up IRQs (opposite of irq_setup) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p></li>
<li><p><strong>enable_reconfig_irq</strong> – Boolean flag to disable reconfiguration interrupts; same purpose as in irq_setup. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414pci_check_msixP15bus_driver_dataP7pci_dev">
<span id="_CPPv314pci_check_msixP15bus_driver_dataP7pci_dev"></span><span id="_CPPv214pci_check_msixP15bus_driver_dataP7pci_dev"></span><span id="pci_check_msix__bus_driver_dataP.pci_devP"></span><span class="target" id="pci__xdma_8h_1aad5f9613fd88cf986726c730355a4aa8"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pci_check_msix</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pdev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414pci_check_msixP15bus_driver_dataP7pci_dev" title="Link to this definition"></a><br /></dt>
<dd><p>Checks if MSI-X is supported and enabled for the PCI device. </p>
<p>This function verifies the presence of MSI-X capability in the PCI device and allocates the required number of MSI-X vectors, which are later used in irq_setup.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p></li>
<li><p><strong>pdev</strong> – Pointer to the PCI device structure associated with the Coyote device. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success, negative error code on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421get_engine_channel_idP16xdma_engine_regs">
<span id="_CPPv321get_engine_channel_idP16xdma_engine_regs"></span><span id="_CPPv221get_engine_channel_idP16xdma_engine_regs"></span><span id="get_engine_channel_id__xdma_engine_regsP"></span><span class="target" id="pci__xdma_8h_1ab5d960ab566133a0f289e2756cb3ebd1"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_engine_channel_id</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xdma_engine_regs</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">regs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421get_engine_channel_idP16xdma_engine_regs" title="Link to this definition"></a><br /></dt>
<dd><p>Returns the channel ID of the engine; see Tables 41 &amp; 60 in the XDMA specification [PG195 (v4.1)]. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413get_engine_idP16xdma_engine_regs">
<span id="_CPPv313get_engine_idP16xdma_engine_regs"></span><span id="_CPPv213get_engine_idP16xdma_engine_regs"></span><span id="get_engine_id__xdma_engine_regsP"></span><span class="target" id="pci__xdma_8h_1a8503ceabd39aca66f8b1d42db8353d8c"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_engine_id</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xdma_engine_regs</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">regs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413get_engine_idP16xdma_engine_regs" title="Link to this definition"></a><br /></dt>
<dd><p>Returns the enginer ID; see Tables 41 &amp; 60 in the XDMA specification [PG195 (v4.1)]. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422read_engine_alignmentsP11xdma_engine">
<span id="_CPPv322read_engine_alignmentsP11xdma_engine"></span><span id="_CPPv222read_engine_alignmentsP11xdma_engine"></span><span id="read_engine_alignments__xdma_engineP"></span><span class="target" id="pci__xdma_8h_1a2e3f39aa827bd0e9f91a7f2ff62a7cd1"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">read_engine_alignments</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xdma_engine</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">engine</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422read_engine_alignmentsP11xdma_engine" title="Link to this definition"></a><br /></dt>
<dd><p>Reads from the XDMA aligment registers (address bits and alignment, length granularity) and sets the values in the engine struct. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413engine_createP15bus_driver_dataiii">
<span id="_CPPv313engine_createP15bus_driver_dataiii"></span><span id="_CPPv213engine_createP15bus_driver_dataiii"></span><span id="engine_create__bus_driver_dataP.i.i.i"></span><span class="target" id="pci__xdma_8h_1ac73a76bdf55563c69b20e7e1ccd4ce25"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xdma_engine</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">engine_create</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">offs</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">c2h</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">channel</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413engine_createP15bus_driver_dataiii" title="Link to this definition"></a><br /></dt>
<dd><p>Creates a C2H or H2C engine. </p>
<p>Allocates and initializes an XDMA engine structure for either C2H (Card-to-Host) or H2C (Host-to-Card) data transfer. It sets up the engine metadata, including its channel and direction. Additionally, it resets the engine by writing to its control registers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p></li>
<li><p><strong>offset</strong> – Offset of the engine configuration register; obtained from the XDMA specification [PG195 (v4.1)], Table 38 </p></li>
<li><p><strong>c2h</strong> – Direction of the engine (1 for C2H, 0 for H2C) </p></li>
<li><p><strong>channel</strong> – Channel number of the engine </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pointer to the created engine structure, or NULL on failure </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416probe_for_engineP15bus_driver_dataii">
<span id="_CPPv316probe_for_engineP15bus_driver_dataii"></span><span id="_CPPv216probe_for_engineP15bus_driver_dataii"></span><span id="probe_for_engine__bus_driver_dataP.i.i"></span><span class="target" id="pci__xdma_8h_1ad866719bc134875f8caaafa2a5da9443"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">probe_for_engine</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">c2h</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">channel</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416probe_for_engineP15bus_driver_dataii" title="Link to this definition"></a><br /></dt>
<dd><p>Probes a single C2H or H2C engine. </p>
<p>This function initializes an XDMA engine for a specific channel and direction. Mostly a wrapper around engine_create, but also performs some sanity checks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p></li>
<li><p><strong>c2h</strong> – Direction of the engine (1 for C2H, 0 for H2C) </p></li>
<li><p><strong>channel</strong> – Channel number of the engine </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success, negative error code on failure </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413probe_enginesP15bus_driver_data">
<span id="_CPPv313probe_enginesP15bus_driver_data"></span><span id="_CPPv213probe_enginesP15bus_driver_data"></span><span id="probe_engines__bus_driver_dataP"></span><span class="target" id="pci__xdma_8h_1a849d934f453ddef52d1fad0d9d49ef00"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">probe_engines</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413probe_enginesP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Probes all C2H and H2C engines. </p>
<p>This function iterates through all available channels and initializes XDMA engines for both C2H and H2C directions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success, negative error code on failure </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414engine_destroyP15bus_driver_dataP11xdma_engine">
<span id="_CPPv314engine_destroyP15bus_driver_dataP11xdma_engine"></span><span id="_CPPv214engine_destroyP15bus_driver_dataP11xdma_engine"></span><span id="engine_destroy__bus_driver_dataP.xdma_engineP"></span><span class="target" id="pci__xdma_8h_1a1de38a0ecc5e3c17a88ac9f66f57fdb8"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">engine_destroy</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xdma_engine</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">engine</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414engine_destroyP15bus_driver_dataP11xdma_engine" title="Link to this definition"></a><br /></dt>
<dd><p>Removes a single XDMA engine. </p>
<p>Deallocates resources associated with a specific XDMA engine and resets control registers in hardware.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p></li>
<li><p><strong>engine</strong> – Pointer to the XDMA engine structure to be removed </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414remove_enginesP15bus_driver_data">
<span id="_CPPv314remove_enginesP15bus_driver_data"></span><span id="_CPPv214remove_enginesP15bus_driver_data"></span><span id="remove_engines__bus_driver_dataP"></span><span class="target" id="pci__xdma_8h_1aa244ec3dd01004adbfaba40ccaf1b727"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">remove_engines</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414remove_enginesP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Remove all XDMA engines. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414map_single_barP15bus_driver_dataP7pci_devii">
<span id="_CPPv314map_single_barP15bus_driver_dataP7pci_devii"></span><span id="_CPPv214map_single_barP15bus_driver_dataP7pci_devii"></span><span id="map_single_bar__bus_driver_dataP.pci_devP.i.i"></span><span class="target" id="pci__xdma_8h_1aa2a674cc9dec39dd1231c1ce7177f800"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">map_single_bar</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pdev</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">idx</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">curr_idx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414map_single_barP15bus_driver_dataP7pci_devii" title="Link to this definition"></a><br /></dt>
<dd><p>Maps a single BAR (Base Address Register) of the PCI device. </p>
<p>This function maps a specific BAR to the driver’s address space, using the <code class="docutils literal notranslate"><span class="pre">pci_iomap</span></code> function. Additionally, it includes sanity checks for the BAR type and size.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We need to distinguish between idx and curr_idx, since in Coyote curr_idx goes can be 0, 1, 2 However, idx is the index of the BAR in the PCI device structure, which can be between 0 and 6. If the XDMA core is configure to have 64-bit addresses, then each BAR takes two slots, as explained in Table 3 of the XDMA specification [PG195 (v4.1)]. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information. </p></li>
<li><p><strong>pdev</strong> – Pointer to the PCI device structure. </p></li>
<li><p><strong>idx</strong> – Index of the BAR to be mapped. </p></li>
<li><p><strong>curr_idx</strong> – Index in the driver’s BAR array where the mapped BAR will be stored. This is incremented for each successfully mapped BAR and ensures that the mapped BARs are stored sequentially in the driver’s data structure. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success, negative error code on failure.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv48map_barsP15bus_driver_dataP7pci_dev">
<span id="_CPPv38map_barsP15bus_driver_dataP7pci_dev"></span><span id="_CPPv28map_barsP15bus_driver_dataP7pci_dev"></span><span id="map_bars__bus_driver_dataP.pci_devP"></span><span class="target" id="pci__xdma_8h_1a0c91a6b5fc25dd0439fe427bfa9190bc"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">map_bars</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pdev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv48map_barsP15bus_driver_dataP7pci_dev" title="Link to this definition"></a><br /></dt>
<dd><p>Maps all BARs for the Coyote driver. </p>
<p>This function iterates through all available BARs of the PCI device and maps them into the driver’s address space using <code class="docutils literal notranslate"><span class="pre">map_single_bar</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p></li>
<li><p><strong>pdev</strong> – Pointer to the PCI device structure </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success, negative error code on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410unmap_barsP15bus_driver_dataP7pci_dev">
<span id="_CPPv310unmap_barsP15bus_driver_dataP7pci_dev"></span><span id="_CPPv210unmap_barsP15bus_driver_dataP7pci_dev"></span><span id="unmap_bars__bus_driver_dataP.pci_devP"></span><span class="target" id="pci__xdma_8h_1a94569c9f15349702733846b75108601f"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">unmap_bars</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pdev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410unmap_barsP15bus_driver_dataP7pci_dev" title="Link to this definition"></a><br /></dt>
<dd><p>Unmaps all previously mapped BARs of the PCI device. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p></li>
<li><p><strong>pdev</strong> – Pointer to the PCI device structure. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414shell_pci_initP15bus_driver_data">
<span id="_CPPv314shell_pci_initP15bus_driver_data"></span><span id="_CPPv214shell_pci_initP15bus_driver_data"></span><span id="shell_pci_init__bus_driver_dataP"></span><span class="target" id="pci__xdma_8h_1ae6f7c2d6fe10f8d7fc835cccf28123b9"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">shell_pci_init</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414shell_pci_initP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>(Re-)Initializes the Coyote shell when running on PCI platforms </p>
<p>This function implements a subset of the pci_probe functionality and it should be used to re-initialize the Coyote shell after partial reconfiguration It is called from reconfig_ops.c during the reconfiguration process</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success, negative error code on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416shell_pci_removeP15bus_driver_data">
<span id="_CPPv316shell_pci_removeP15bus_driver_data"></span><span id="_CPPv216shell_pci_removeP15bus_driver_data"></span><span id="shell_pci_remove__bus_driver_dataP"></span><span class="target" id="pci__xdma_8h_1a58f8cbb6315a2648f2be3a4dee751ef7"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">shell_pci_remove</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">bus_driver_data</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416shell_pci_removeP15bus_driver_data" title="Link to this definition"></a><br /></dt>
<dd><p>Clears the state of the Coyote shell when running on PCI platforms. </p>
<p>This function releases the resources and resets the hardware components associated with the shell layer. Only called when the shell is removed through reconfiguration (from reconfig_ops.c).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Pointer to the bus driver data structure, containing Coyote device information </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv49pci_probeP7pci_devPK13pci_device_id">
<span id="_CPPv39pci_probeP7pci_devPK13pci_device_id"></span><span id="_CPPv29pci_probeP7pci_devPK13pci_device_id"></span><span id="pci_probe__pci_devP.pci_device_idCP"></span><span class="target" id="pci__xdma_8h_1a7226abb3077328d143dc7723ffd39102"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pci_probe</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pdev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_device_id</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">id</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv49pci_probeP7pci_devPK13pci_device_id" title="Link to this definition"></a><br /></dt>
<dd><p>Top-level PCI initialization function for the Coyote driver. </p>
<p>This function is called during the PCI device enumeration process to initialize the Coyote driver for the detected PCI device. It sets up the necessary resources, mapping the device’s BARs, initializing the XDMA engines, setting up char devices etc. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410pci_removeP7pci_dev">
<span id="_CPPv310pci_removeP7pci_dev"></span><span id="_CPPv210pci_removeP7pci_dev"></span><span id="pci_remove__pci_devP"></span><span class="target" id="pci__xdma_8h_1afba91ec3cfaa5fa7f8e5958a9fd66872"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pci_remove</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pdev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410pci_removeP7pci_dev" title="Link to this definition"></a><br /></dt>
<dd><p>Top-level PCI device removal function for the Coyote driver. </p>
<p>This function is called during the PCI device removal process to clean up the resources and de-initialize the Coyote driver </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv48pci_initv">
<span id="_CPPv38pci_initv"></span><span id="_CPPv28pci_initv"></span><span id="pci_init__void"></span><span class="target" id="pci__xdma_8h_1aea12ee1dea0b75b6bd3d1ba4c3293c5d"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pci_init</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv48pci_initv" title="Link to this definition"></a><br /></dt>
<dd><p>Top-level entry function, called by coyote_init and simply a wrapper around pci_probe. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv48pci_exitv">
<span id="_CPPv38pci_exitv"></span><span id="_CPPv28pci_exitv"></span><span id="pci_exit__void"></span><span class="target" id="pci__xdma_8h_1a392530e9c586bba5991f18039956746b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pci_exit</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv48pci_exitv" title="Link to this definition"></a><br /></dt>
<dd><p>Top-level exit function, called by coyote_exit and simply a wrapper around pci_remove. </p>
</dd></dl>

</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="sw.html" class="btn btn-neutral float-left" title="Software" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, System Group, ETH Zurich.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>